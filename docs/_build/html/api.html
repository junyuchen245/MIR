

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; MIR 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=f6245a2f"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MIR.models" href="api/MIR.models.html" />
    <link rel="prev" title="Quick Start" href="quick_start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MIR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/MIR.models.html">MIR.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/MIR.utils.html">MIR.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/MIR.image_similarity.html">MIR.image_similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/MIR.deformation_regularizer.html">MIR.deformation_regularizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/MIR.accuracy_measures.html">MIR.accuracy_measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.AdvancedDecoder3D"><code class="docutils literal notranslate"><span class="pre">AdvancedDecoder3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AdvancedDecoder3D.forward"><code class="docutils literal notranslate"><span class="pre">AdvancedDecoder3D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.AffineTransformer"><code class="docutils literal notranslate"><span class="pre">AffineTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AffineTransformer.apply_affine"><code class="docutils literal notranslate"><span class="pre">AffineTransformer.apply_affine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AffineTransformer.forward"><code class="docutils literal notranslate"><span class="pre">AffineTransformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.Conv3dReLU"><code class="docutils literal notranslate"><span class="pre">Conv3dReLU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ConvNeXtSynthHead3D"><code class="docutils literal notranslate"><span class="pre">ConvNeXtSynthHead3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.ConvNeXtSynthHead3D.forward"><code class="docutils literal notranslate"><span class="pre">ConvNeXtSynthHead3D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.get_candidate_from_tensor"><code class="docutils literal notranslate"><span class="pre">Decoder.get_candidate_from_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.to_token"><code class="docutils literal notranslate"><span class="pre">Decoder.to_token()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DecoderBlock"><code class="docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DecoderBlock.forward"><code class="docutils literal notranslate"><span class="pre">DecoderBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DefSwinTransformer"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.forward"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.init_weights"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.init_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.train"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.forward"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.init_weights"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.init_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.train"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DoubleConv3d"><code class="docutils literal notranslate"><span class="pre">DoubleConv3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DoubleConv3d.forward"><code class="docutils literal notranslate"><span class="pre">DoubleConv3d.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.EfficientAdvancedSynthHead3D"><code class="docutils literal notranslate"><span class="pre">EfficientAdvancedSynthHead3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EfficientAdvancedSynthHead3D.forward"><code class="docutils literal notranslate"><span class="pre">EfficientAdvancedSynthHead3D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor.forward"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor.get_shapes"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor.get_shapes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.GroupNet3D"><code class="docutils literal notranslate"><span class="pre">GroupNet3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.GroupNet3D.forward"><code class="docutils literal notranslate"><span class="pre">GroupNet3D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.GroupNormalizerFactory"><code class="docutils literal notranslate"><span class="pre">GroupNormalizerFactory</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.GroupNormalizerFactory.build"><code class="docutils literal notranslate"><span class="pre">GroupNormalizerFactory.build()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperTransMorphTVF"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVF</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperTransMorphTVF.forward"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVF.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperTransMorphTVFSPR"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVFSPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperTransMorphTVFSPR.forward"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVFSPR.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperVFA"><code class="docutils literal notranslate"><span class="pre">HyperVFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVFA.forward"><code class="docutils literal notranslate"><span class="pre">HyperVFA.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperVFASPR"><code class="docutils literal notranslate"><span class="pre">HyperVFASPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVFASPR.forward"><code class="docutils literal notranslate"><span class="pre">HyperVFASPR.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperVxmDense"><code class="docutils literal notranslate"><span class="pre">HyperVxmDense</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVxmDense.forward"><code class="docutils literal notranslate"><span class="pre">HyperVxmDense.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ListBatchSampler"><code class="docutils literal notranslate"><span class="pre">ListBatchSampler</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.MappingPair"><code class="docutils literal notranslate"><span class="pre">MappingPair</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MappingPair.forward_mapping"><code class="docutils literal notranslate"><span class="pre">MappingPair.forward_mapping</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MappingPair.inverse_mapping"><code class="docutils literal notranslate"><span class="pre">MappingPair.inverse_mapping</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.MeanStream"><code class="docutils literal notranslate"><span class="pre">MeanStream</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MeanStream.forward"><code class="docutils literal notranslate"><span class="pre">MeanStream.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MeanStream.mean_update"><code class="docutils literal notranslate"><span class="pre">MeanStream.mean_update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ReLUFactory"><code class="docutils literal notranslate"><span class="pre">ReLUFactory</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.ReLUFactory.build"><code class="docutils literal notranslate"><span class="pre">ReLUFactory.build()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.RegistrationHead"><code class="docutils literal notranslate"><span class="pre">RegistrationHead</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SITReg"><code class="docutils literal notranslate"><span class="pre">SITReg</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.forward"><code class="docutils literal notranslate"><span class="pre">SITReg.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.image_coordinate_system"><code class="docutils literal notranslate"><span class="pre">SITReg.image_coordinate_system</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.transformation_coordinate_system"><code class="docutils literal notranslate"><span class="pre">SITReg.transformation_coordinate_system</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SSLHead1Lvl"><code class="docutils literal notranslate"><span class="pre">SSLHead1Lvl</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SSLHead1Lvl.forward"><code class="docutils literal notranslate"><span class="pre">SSLHead1Lvl.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SSLHeadNLvl"><code class="docutils literal notranslate"><span class="pre">SSLHeadNLvl</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SSLHeadNLvl.forward"><code class="docutils literal notranslate"><span class="pre">SSLHeadNLvl.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SpatialTransformer"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SpatialTransformer.forward"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SwinTransformer"><code class="docutils literal notranslate"><span class="pre">SwinTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.init_weights"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.init_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.train"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SynthesisHead3D"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SynthesisHead3D.forward"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SynthesisHead3DAdvanced"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3DAdvanced</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SynthesisHead3DAdvanced.forward"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3DAdvanced.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TemplateCreation"><code class="docutils literal notranslate"><span class="pre">TemplateCreation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TemplateCreation.forward"><code class="docutils literal notranslate"><span class="pre">TemplateCreation.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorph"><code class="docutils literal notranslate"><span class="pre">TransMorph</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorph.forward"><code class="docutils literal notranslate"><span class="pre">TransMorph.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorphAffine"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphAffine.forward"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphAffine.softplus"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine.softplus()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorphTVF"><code class="docutils literal notranslate"><span class="pre">TransMorphTVF</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphTVF.forward"><code class="docutils literal notranslate"><span class="pre">TransMorphTVF.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorphTVFSPR"><code class="docutils literal notranslate"><span class="pre">TransMorphTVFSPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphTVFSPR.forward"><code class="docutils literal notranslate"><span class="pre">TransMorphTVFSPR.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransVFA"><code class="docutils literal notranslate"><span class="pre">TransVFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransVFA.forward"><code class="docutils literal notranslate"><span class="pre">TransVFA.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VFA"><code class="docutils literal notranslate"><span class="pre">VFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VFA.forward"><code class="docutils literal notranslate"><span class="pre">VFA.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VFASPR"><code class="docutils literal notranslate"><span class="pre">VFASPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VFASPR.forward"><code class="docutils literal notranslate"><span class="pre">VFASPR.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VecInt"><code class="docutils literal notranslate"><span class="pre">VecInt</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VecInt.forward"><code class="docutils literal notranslate"><span class="pre">VecInt.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VxmDense"><code class="docutils literal notranslate"><span class="pre">VxmDense</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VxmDense.forward"><code class="docutils literal notranslate"><span class="pre">VxmDense.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.Warp3d"><code class="docutils literal notranslate"><span class="pre">Warp3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Warp3d.forward"><code class="docutils literal notranslate"><span class="pre">Warp3d.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_MIND"><code class="docutils literal notranslate"><span class="pre">convex_adam_MIND()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_MIND_SPR"><code class="docutils literal notranslate"><span class="pre">convex_adam_MIND_SPR()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_features"><code class="docutils literal notranslate"><span class="pre">convex_adam_features()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_seg_features"><code class="docutils literal notranslate"><span class="pre">convex_adam_seg_features()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ensemble_average"><code class="docutils literal notranslate"><span class="pre">ensemble_average()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.fit_warp_to_svf"><code class="docutils literal notranslate"><span class="pre">fit_warp_to_svf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorph3Lvl_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorph3Lvl_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphDWin3Lvl_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphDWin3Lvl_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphLarge_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphLarge_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphLrn_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphLrn_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoConvSkip_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoConvSkip_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoRelativePosEmbd_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoRelativePosEmbd_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoSkip_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoSkip_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoTransSkip_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoTransSkip_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphRelativePosEmbdSimple_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphRelativePosEmbdSimple_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphSin_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphSin_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphSmall_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphSmall_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphTiny_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphTiny_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorph_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorph_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_ConvexAdam_MIND_brain_default_config"><code class="docutils literal notranslate"><span class="pre">get_ConvexAdam_MIND_brain_default_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VFA_default_config"><code class="docutils literal notranslate"><span class="pre">get_VFA_default_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VXM_1_config"><code class="docutils literal notranslate"><span class="pre">get_VXM_1_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VXM_BJ_config"><code class="docutils literal notranslate"><span class="pre">get_VXM_BJ_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VXM_default_config"><code class="docutils literal notranslate"><span class="pre">get_VXM_default_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.grid_to_flow"><code class="docutils literal notranslate"><span class="pre">grid_to_flow()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.invert_warp_via_velocity"><code class="docutils literal notranslate"><span class="pre">invert_warp_via_velocity()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.make_epoch_batches"><code class="docutils literal notranslate"><span class="pre">make_epoch_batches()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.AverageMeter"><code class="docutils literal notranslate"><span class="pre">AverageMeter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.utils.AverageMeter.reset"><code class="docutils literal notranslate"><span class="pre">AverageMeter.reset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.utils.AverageMeter.update"><code class="docutils literal notranslate"><span class="pre">AverageMeter.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.utils.Logger.flush"><code class="docutils literal notranslate"><span class="pre">Logger.flush()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.utils.Logger.write"><code class="docutils literal notranslate"><span class="pre">Logger.write()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.MultiResPatchSampler3D"><code class="docutils literal notranslate"><span class="pre">MultiResPatchSampler3D</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.RandomPatchSampler3D"><code class="docutils literal notranslate"><span class="pre">RandomPatchSampler3D</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.SLANT_label_reassign"><code class="docutils literal notranslate"><span class="pre">SLANT_label_reassign()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.SpatialTransformer"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.utils.SpatialTransformer.forward"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.VecInt"><code class="docutils literal notranslate"><span class="pre">VecInt</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.utils.VecInt.forward"><code class="docutils literal notranslate"><span class="pre">VecInt.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.get_cmap"><code class="docutils literal notranslate"><span class="pre">get_cmap()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.load_partial_weights"><code class="docutils literal notranslate"><span class="pre">load_partial_weights()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.make_affine_from_pixdim"><code class="docutils literal notranslate"><span class="pre">make_affine_from_pixdim()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.mk_grid_img"><code class="docutils literal notranslate"><span class="pre">mk_grid_img()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.pad_image"><code class="docutils literal notranslate"><span class="pre">pad_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.pkload"><code class="docutils literal notranslate"><span class="pre">pkload()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.resample_to_orginal_space_and_save"><code class="docutils literal notranslate"><span class="pre">resample_to_orginal_space_and_save()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.savepkl"><code class="docutils literal notranslate"><span class="pre">savepkl()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.sliding_window_inference"><code class="docutils literal notranslate"><span class="pre">sliding_window_inference()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.write2csv"><code class="docutils literal notranslate"><span class="pre">write2csv()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.utils.zoom_img"><code class="docutils literal notranslate"><span class="pre">zoom_img()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.CompRecon"><code class="docutils literal notranslate"><span class="pre">CompRecon</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.CompRecon.forward"><code class="docutils literal notranslate"><span class="pre">CompRecon.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.CorrRatio"><code class="docutils literal notranslate"><span class="pre">CorrRatio</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.CorrRatio.correlation_ratio"><code class="docutils literal notranslate"><span class="pre">CorrRatio.correlation_ratio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.CorrRatio.forward"><code class="docutils literal notranslate"><span class="pre">CorrRatio.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.CorrRatio.gaussian_kernel"><code class="docutils literal notranslate"><span class="pre">CorrRatio.gaussian_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.CorrRatio.vol_bin_centers"><code class="docutils literal notranslate"><span class="pre">CorrRatio.vol_bin_centers</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.DiceLoss"><code class="docutils literal notranslate"><span class="pre">DiceLoss</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.DiceLoss.forward"><code class="docutils literal notranslate"><span class="pre">DiceLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.DiceSegLoss"><code class="docutils literal notranslate"><span class="pre">DiceSegLoss</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.DiceSegLoss.forward"><code class="docutils literal notranslate"><span class="pre">DiceSegLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.FastNCC"><code class="docutils literal notranslate"><span class="pre">FastNCC</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.FastNCC.forward"><code class="docutils literal notranslate"><span class="pre">FastNCC.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.LocalCorrRatio"><code class="docutils literal notranslate"><span class="pre">LocalCorrRatio</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.LocalCorrRatio.correlation_ratio"><code class="docutils literal notranslate"><span class="pre">LocalCorrRatio.correlation_ratio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.LocalCorrRatio.forward"><code class="docutils literal notranslate"><span class="pre">LocalCorrRatio.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.LocalCorrRatio.gaussian_kernel"><code class="docutils literal notranslate"><span class="pre">LocalCorrRatio.gaussian_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.LocalCorrRatio.vol_bin_centers"><code class="docutils literal notranslate"><span class="pre">LocalCorrRatio.vol_bin_centers</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.MIND_loss"><code class="docutils literal notranslate"><span class="pre">MIND_loss</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.MIND_loss.MINDSSC"><code class="docutils literal notranslate"><span class="pre">MIND_loss.MINDSSC()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.MIND_loss.forward"><code class="docutils literal notranslate"><span class="pre">MIND_loss.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.MIND_loss.pdist_squared"><code class="docutils literal notranslate"><span class="pre">MIND_loss.pdist_squared()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.MutualInformation"><code class="docutils literal notranslate"><span class="pre">MutualInformation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.MutualInformation.forward"><code class="docutils literal notranslate"><span class="pre">MutualInformation.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.MutualInformation.mi"><code class="docutils literal notranslate"><span class="pre">MutualInformation.mi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC"><code class="docutils literal notranslate"><span class="pre">NCC</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC.forward"><code class="docutils literal notranslate"><span class="pre">NCC.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC_fp16"><code class="docutils literal notranslate"><span class="pre">NCC_fp16</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_fp16.forward"><code class="docutils literal notranslate"><span class="pre">NCC_fp16.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC_gauss"><code class="docutils literal notranslate"><span class="pre">NCC_gauss</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_gauss.create_window_3D"><code class="docutils literal notranslate"><span class="pre">NCC_gauss.create_window_3D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_gauss.forward"><code class="docutils literal notranslate"><span class="pre">NCC_gauss.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_gauss.gaussian"><code class="docutils literal notranslate"><span class="pre">NCC_gauss.gaussian()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC_mok"><code class="docutils literal notranslate"><span class="pre">NCC_mok</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_mok.forward"><code class="docutils literal notranslate"><span class="pre">NCC_mok.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC_mok2"><code class="docutils literal notranslate"><span class="pre">NCC_mok2</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_mok2.forward"><code class="docutils literal notranslate"><span class="pre">NCC_mok2.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC_vfa"><code class="docutils literal notranslate"><span class="pre">NCC_vfa</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_vfa.forward"><code class="docutils literal notranslate"><span class="pre">NCC_vfa.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.NCC_vxm"><code class="docutils literal notranslate"><span class="pre">NCC_vxm</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.NCC_vxm.forward"><code class="docutils literal notranslate"><span class="pre">NCC_vxm.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.PCC"><code class="docutils literal notranslate"><span class="pre">PCC</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.PCC.forward"><code class="docutils literal notranslate"><span class="pre">PCC.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.PCC.pcc"><code class="docutils literal notranslate"><span class="pre">PCC.pcc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.SSIM2D"><code class="docutils literal notranslate"><span class="pre">SSIM2D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.SSIM2D.forward"><code class="docutils literal notranslate"><span class="pre">SSIM2D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.SSIM3D"><code class="docutils literal notranslate"><span class="pre">SSIM3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.SSIM3D.forward"><code class="docutils literal notranslate"><span class="pre">SSIM3D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.SegmentationLoss"><code class="docutils literal notranslate"><span class="pre">SegmentationLoss</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.SegmentationLoss.forward"><code class="docutils literal notranslate"><span class="pre">SegmentationLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.create_window"><code class="docutils literal notranslate"><span class="pre">create_window()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.create_window_3D"><code class="docutils literal notranslate"><span class="pre">create_window_3D()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.gaussian"><code class="docutils literal notranslate"><span class="pre">gaussian()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.localMutualInformation"><code class="docutils literal notranslate"><span class="pre">localMutualInformation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.localMutualInformation.forward"><code class="docutils literal notranslate"><span class="pre">localMutualInformation.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.image_similarity.localMutualInformation.local_mi"><code class="docutils literal notranslate"><span class="pre">localMutualInformation.local_mi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.ssim"><code class="docutils literal notranslate"><span class="pre">ssim()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.image_similarity.ssim3D"><code class="docutils literal notranslate"><span class="pre">ssim3D()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.compute_bending_energy"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.compute_bending_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.compute_gradient_norm"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.compute_gradient_norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.forward"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_dx"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.gradient_dx()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_dy"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.gradient_dy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_dz"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.gradient_dz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_txyz"><code class="docutils literal notranslate"><span class="pre">DisplacementRegularizer.gradient_txyz()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.Grad2D"><code class="docutils literal notranslate"><span class="pre">Grad2D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.Grad2D.forward"><code class="docutils literal notranslate"><span class="pre">Grad2D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.Grad3DiTV"><code class="docutils literal notranslate"><span class="pre">Grad3DiTV</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.Grad3DiTV.forward"><code class="docutils literal notranslate"><span class="pre">Grad3DiTV.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.Grad3d"><code class="docutils literal notranslate"><span class="pre">Grad3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.Grad3d.forward"><code class="docutils literal notranslate"><span class="pre">Grad3d.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.GradICON3d"><code class="docutils literal notranslate"><span class="pre">GradICON3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.GradICON3d.forward"><code class="docutils literal notranslate"><span class="pre">GradICON3d.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.GradICONExact3d"><code class="docutils literal notranslate"><span class="pre">GradICONExact3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.GradICONExact3d.forward"><code class="docutils literal notranslate"><span class="pre">GradICONExact3d.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.KL_divergence"><code class="docutils literal notranslate"><span class="pre">KL_divergence</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.KL_divergence.forward"><code class="docutils literal notranslate"><span class="pre">KL_divergence.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.LocalGrad3d"><code class="docutils literal notranslate"><span class="pre">LocalGrad3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.LocalGrad3d.forward"><code class="docutils literal notranslate"><span class="pre">LocalGrad3d.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.MultiVariateKL_divergence"><code class="docutils literal notranslate"><span class="pre">MultiVariateKL_divergence</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.MultiVariateKL_divergence.forward"><code class="docutils literal notranslate"><span class="pre">MultiVariateKL_divergence.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.logBeta"><code class="docutils literal notranslate"><span class="pre">logBeta</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.logBeta.forward"><code class="docutils literal notranslate"><span class="pre">logBeta.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.deformation_regularizer.logGaussian"><code class="docutils literal notranslate"><span class="pre">logGaussian</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.deformation_regularizer.logGaussian.forward"><code class="docutils literal notranslate"><span class="pre">logGaussian.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.calc_J_i"><code class="docutils literal notranslate"><span class="pre">calc_J_i()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.calc_Jstar_1"><code class="docutils literal notranslate"><span class="pre">calc_Jstar_1()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.calc_Jstar_2"><code class="docutils literal notranslate"><span class="pre">calc_Jstar_2()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.calc_jac_dets"><code class="docutils literal notranslate"><span class="pre">calc_jac_dets()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.calc_measurements"><code class="docutils literal notranslate"><span class="pre">calc_measurements()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.dice_val_VOI"><code class="docutils literal notranslate"><span class="pre">dice_val_VOI()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.dice_val_all"><code class="docutils literal notranslate"><span class="pre">dice_val_all()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.dice_val_substruct"><code class="docutils literal notranslate"><span class="pre">dice_val_substruct()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.accuracy_measures.get_identity_grid"><code class="docutils literal notranslate"><span class="pre">get_identity_grid()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MIR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h1>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-MIR.models" title="MIR.models"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MIR.models</span></code></a></p></td>
<td><p>Model zoo and configuration helpers for MIR registration pipelines.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-MIR.utils" title="MIR.utils"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MIR.utils</span></code></a></p></td>
<td><p>Utility helpers for registration, training, visualization, and IO.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-MIR.image_similarity" title="MIR.image_similarity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MIR.image_similarity</span></code></a></p></td>
<td><p>Image similarity losses and metrics used in MIR registration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-MIR.deformation_regularizer" title="MIR.deformation_regularizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MIR.deformation_regularizer</span></code></a></p></td>
<td><p>Regularization terms for deformation fields and velocity models.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-MIR.accuracy_measures" title="MIR.accuracy_measures"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MIR.accuracy_measures</span></code></a></p></td>
<td><p>Accuracy metrics and Jacobian-based measures for evaluation.</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-MIR.models"></span><p>Model zoo and configuration helpers for MIR registration pipelines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.AdvancedDecoder3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">AdvancedDecoder3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Segmentation_Heads.html#AdvancedDecoder3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AdvancedDecoder3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Advanced 3D decoder for multi-resolution encoder features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder_channels</strong>  List of channel counts for each feature level.</p></li>
<li><p><strong>aspp_out</strong>  Number of channels after ASPP.</p></li>
<li><p><strong>num_classes</strong>  Number of output classes.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><p>x_feats: List of feature maps ordered from low to high resolution.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Logits tensor of shape [B, num_classes, D0, H0, W0].</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.AdvancedDecoder3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_feats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Segmentation_Heads.html#AdvancedDecoder3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AdvancedDecoder3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run decoder forward pass.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">AffineTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#AffineTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AffineTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>3-D Affine Transformer
:param mode: interpolation mode, bilinear or nearest</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer.apply_affine">
<span class="sig-name descname"><span class="pre">apply_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#AffineTransformer.apply_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AffineTransformer.apply_affine" title="Permalink to this definition"></a></dt>
<dd><p>Apply an affine matrix to a source volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong>  Source tensor (B, C, H, W, D).</p></li>
<li><p><strong>mat</strong>  Affine matrix (B, 3, 4).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Warped tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#AffineTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AffineTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply composed affine parameters to a volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong>  Source tensor (B, C, H, W, D).</p></li>
<li><p><strong>affine</strong>  Rotation parameters (B, 3).</p></li>
<li><p><strong>scale</strong>  Scale parameters (B, 3).</p></li>
<li><p><strong>translate</strong>  Translation parameters (B, 3).</p></li>
<li><p><strong>shear</strong>  Shear parameters (B, 6).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (warped, affine_matrix, inverse_affine_matrix).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.Conv3dReLU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">Conv3dReLU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#Conv3dReLU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Conv3dReLU" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequential</span></code></p>
<p>3D convolution + normalization + LeakyReLU block.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.ConvNeXtSynthHead3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ConvNeXtSynthHead3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#ConvNeXtSynthHead3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ConvNeXtSynthHead3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.ConvNeXtSynthHead3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#ConvNeXtSynthHead3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ConvNeXtSynthHead3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (B, C, H, W, D)
returns: (B, 1, H, W, D)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.Decoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">Decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA decoder network.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>F: List of fixed-image feature maps.
M: List of moving-image feature maps.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of composed grids at each scale.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Decoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Decoder.get_candidate_from_tensor">
<span class="sig-name descname"><span class="pre">get_candidate_from_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder.get_candidate_from_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder.get_candidate_from_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Extract local patches into a token tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>  Tensor of shape [B, C, <a href="#id1"><span class="problematic" id="id2">*</span></a>spatial].</p></li>
<li><p><strong>dim</strong>  Spatial dimensionality (2 or 3).</p></li>
<li><p><strong>kernel</strong>  Patch size.</p></li>
<li><p><strong>stride</strong>  Patch stride.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape [B, <a href="#id3"><span class="problematic" id="id4">*</span></a>spatial, P, C] with patch tokens.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Decoder.to_token">
<span class="sig-name descname"><span class="pre">to_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder.to_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder.to_token" title="Permalink to this definition"></a></dt>
<dd><p>Flatten spatial dimensions and move channels to the last axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong>  Tensor of shape [B, C, <a href="#id5"><span class="problematic" id="id6">*</span></a>spatial].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape [B, N, C] where N is the flattened spatial size.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DecoderBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DecoderBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#DecoderBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DecoderBlock" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Decoder block with upsampling and optional skip connection.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DecoderBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#DecoderBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DecoderBlock.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong>  Tensor of shape [B, C, D, H, W].</p></li>
<li><p><strong>skip</strong>  Optional skip tensor concatenated on channel axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor after upsampling and convolutions.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DefSwinTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl>
<dt>Swin Transformer</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>)  Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>)  Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>)  Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>)  Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>)  Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>)  Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>)  Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em>)  Window size. Default: 7</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>)  Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>)  If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>)  Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>)  Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>)  Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>)  Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>)  Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>)  If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>)  If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>)  Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer.init_weights" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer.train" title="Permalink to this definition"></a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DefSwinTransformerV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl>
<dt>Deformable Swin Transformer</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>)  Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>)  Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>)  Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>)  Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>)  Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>)  Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>)  Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em>)  Window size. Default: 7</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>)  Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>)  If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>)  Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>)  Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>)  Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>)  Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>)  Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>)  If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>)  If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>)  Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.init_weights" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.train" title="Permalink to this definition"></a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DoubleConv3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DoubleConv3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#DoubleConv3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DoubleConv3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Two-layer 3D convolutional block with instance norm and LeakyReLU.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DoubleConv3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#DoubleConv3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DoubleConv3d.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.EfficientAdvancedSynthHead3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">EfficientAdvancedSynthHead3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#EfficientAdvancedSynthHead3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EfficientAdvancedSynthHead3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Memory-efficient advanced synthesis head
using inverted residuals + ECA attention.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.EfficientAdvancedSynthHead3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#EfficientAdvancedSynthHead3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EfficientAdvancedSynthHead3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (B, C, H, W, D)
returns: (B, 1, H, W, D)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">EncoderFeatureExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/feature_extractor.html#EncoderFeatureExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFeatureExtractor</span></code></p>
<p>Simple convolutional ResNet-style feature extractor with
resolution halved at each stage</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_input_channels</strong>  Number of input channels in the input images</p></li>
<li><p><strong>activation</strong>  Activation to use</p></li>
<li><p><strong>n_features_per_resolution</strong>  Number of features to output for each resolution</p></li>
<li><p><strong>n_convolutions_per_resolution</strong>  Number of convolutions to have for each resolution</p></li>
<li><p><strong>input_shape</strong>  Input volume shape</p></li>
<li><p><strong>normalizer_factory</strong>  Defines the normalizer to use</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/feature_extractor.html#EncoderFeatureExtractor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the features</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong>  List of Tensors with shape (batch_size, n_channels, <a href="#id7"><span class="problematic" id="id8">*</span></a>spatial_shape)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor.get_shapes">
<span class="sig-name descname"><span class="pre">get_shapes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/feature_extractor.html#EncoderFeatureExtractor.get_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor.get_shapes" title="Permalink to this definition"></a></dt>
<dd><p>Get shapes at different levels, starting from largest shape</p>
<p>Returns: Sequence of shapes of following form (n_features, dim_1_size, , dim_n_size)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.GroupNet3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">GroupNet3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#GroupNet3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNet3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.GroupNet3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#GroupNet3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNet3D.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.GroupNormalizerFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">GroupNormalizerFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/normalizer.html#GroupNormalizerFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNormalizerFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">INormalizerFactory</span></code></p>
<p>Factory for generating group normalization layers</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.GroupNormalizerFactory.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/normalizer.html#GroupNormalizerFactory.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNormalizerFactory.build" title="Permalink to this definition"></a></dt>
<dd><p>Build normalization layer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperTransMorphTVF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyp_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVF.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVFSPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperTransMorphTVFSPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVFSPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVFSPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph TVF with Spatially-varying regularization
:param config: Configuration object containing model parameters
:param time_steps: Number of time steps for progressive registration
:param SVF: Boolean indicating whether to use SVF (Time Stationary Velocity Field) integration
:param SVF_steps: Number of steps for SVF integration
:param composition: Type of composition for flow integration (composition or addition)
:param swin_type: Type of Swin Transformer to use (swin or dswin)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVFSPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVFSPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVFSPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorphTVFSPR model.
:param inputs: Tuple of moving and fixed images (mov, fix).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed flow field for image registration.
x_weight: The spatial weights for regularization.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>flow</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperVFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperVFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Hyperparameter-conditioned VFA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong>  VFA configuration object.</p></li>
<li><p><strong>device</strong>  Device to run the model on.</p></li>
<li><p><strong>return_orginal</strong>  If True, return composed grids and stats.</p></li>
<li><p><strong>return_all_flows</strong>  If True, return flows for all decoder levels.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>sample: Tuple <cite>(mov, fix)</cite> tensors.
hyper_val: Hyperparameter tensor.</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Flow(s) depending on flags.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperVFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run forward registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p></li>
<li><p><strong>hyper_val</strong>  Hyperparameter tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output varies by flags (<cite>return_orginal</cite>, <cite>return_all_flows</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperVFASPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperVFASPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFASPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFASPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>HyperVFA model with spatially varying regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong>  VFA configuration object.</p></li>
<li><p><strong>device</strong>  Device to run the model on.</p></li>
<li><p><strong>return_orginal</strong>  If True, return composed grids and stats.</p></li>
<li><p><strong>return_all_flows</strong>  If True, return flows for all decoder levels.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>sample: Tuple <cite>(mov, fix)</cite> tensors.
hyper_val: Hyperparameter tensor.</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Flow(s) and spatial weights depending on flags.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperVFASPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFASPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFASPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run forward registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p></li>
<li><p><strong>hyper_val</strong>  Hyperparameter tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output varies by flags (<cite>return_orginal</cite>, <cite>return_all_flows</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperVxmDense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperVxmDense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperMorph.html#HyperVxmDense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVxmDense" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>HyperMorph variant of VoxelMorph with hyperparameter conditioning.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>input_imgs: Tuple <cite>(mov, fix)</cite> of tensors [B, 1, <a href="#id9"><span class="problematic" id="id10">*</span></a>spatial].
hyp_val: Tensor of hyperparameter values.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flow tensor, and optionally warped image if <cite>gen_output</cite> is True.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperVxmDense.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyp_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperMorph.html#HyperVxmDense.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVxmDense.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run HyperMorph forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_imgs</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p></li>
<li><p><strong>hyp_val</strong>  Hyperparameter tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flow tensor, and optionally warped moving image.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.ListBatchSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ListBatchSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#ListBatchSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ListBatchSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></p>
<p>Yield precomputed lists of indices as batches.</p>
<p>This allows constructing a DataLoader with arbitrary batch sizes per iteration
while still supporting num_workers and automatic collation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.MappingPair">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">MappingPair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GridComposableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GridComposableMapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/model.html#MappingPair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MappingPair" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Mapping pair containing both forward and inverse deformation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.MappingPair.forward_mapping">
<span class="sig-name descname"><span class="pre">forward_mapping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">GridComposableMapping</span></em><a class="headerlink" href="#MIR.models.MappingPair.forward_mapping" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.MappingPair.inverse_mapping">
<span class="sig-name descname"><span class="pre">inverse_mapping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">GridComposableMapping</span></em><a class="headerlink" href="#MIR.models.MappingPair.inverse_mapping" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.MeanStream">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">MeanStream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#MeanStream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MeanStream" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Mean stream for the Deformable Template Network
:param cap: Cap for the mean
:param in_shape: Input shape</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.MeanStream.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#MeanStream.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MeanStream.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.MeanStream.mean_update">
<span class="sig-name descname"><span class="pre">mean_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#MeanStream.mean_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MeanStream.mean_update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.ReLUFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ReLUFactory</span></span><a class="reference internal" href="_modules/MIR/models/SITReg/activation.html#ReLUFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ReLUFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">IActivationFactory</span></code></p>
<p>Factory for generating relu activations</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.ReLUFactory.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/activation.html#ReLUFactory.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ReLUFactory.build" title="Permalink to this definition"></a></dt>
<dd><p>Build activation layer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.RegistrationHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">RegistrationHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#RegistrationHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.RegistrationHead" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequential</span></code></p>
<p>Predict a dense displacement field from decoder features.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SITReg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SITReg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/model.html#SITReg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SITReg" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>SITReg is a deep learning intra-modality image registration arhitecture
fulfilling strict symmetry properties</p>
<p>The implementation is dimensionality agnostic but PyTorch linear interpolation
supports only 2 and 3 dimensional volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_extractor</strong>  Multi-resolution feature extractor</p></li>
<li><p><strong>n_transformation_features_per_resolution</strong>  Defines how many features to
use for extracting transformation in anti-symmetric update for each
resolution. If None is given for some resolution, no deformation is
extracted for that.</p></li>
<li><p><strong>n_transformation_convolutions_per_resolution</strong>  Defines how many convolutions to
use for extracting transformation in anti-symmetric update for each
resolution. If None is given for some resolution, no deformation is
extracted for that.</p></li>
<li><p><strong>affine_transformation_type</strong>  Defines which type of affine transformation
to predict. If None, no affine transformation is predicted.</p></li>
<li><p><strong>input_voxel_size</strong>  Voxel size of the inputs images</p></li>
<li><p><strong>input_shape</strong>  Shape of the input images</p></li>
<li><p><strong>transformation_downsampling_factor</strong>  Downsampling factor for each
dimension for the final deformation, e.g., providing [1.0, 1.0, 1.0] means
no downsampling for three dimensional inputs.</p></li>
<li><p><strong>forward_fixed_point_solver</strong>  Defines fixed point solver for the forward pass
of the deformation inversion layers.</p></li>
<li><p><strong>backward_fixed_point_solver</strong>  Defines fixed point solver for the backward pass
of the deformation inversion layers.</p></li>
<li><p><strong>max_control_point_multiplier</strong>  Optimal maximum control point values are
multiplied with this value to ensure that the individual
deformations are invertible even after numerical errors. This should
be some value just below 1, e.g. 0.99.</p></li>
<li><p><strong>activation_factory</strong>  Activation function to use.</p></li>
<li><p><strong>normalizer_factory</strong>  Normalizer factory to use. If None, no normalization</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SITReg.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings_for_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">((0,</span> <span class="pre">True),)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_when_composing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#MIR.models.MappingPair" title="MIR.models.MappingPair"><span class="pre">MappingPair</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/model.html#SITReg.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SITReg.forward" title="Permalink to this definition"></a></dt>
<dd><p>Generate deformations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_1</strong>  Image registered to image_2, Tensor with shape
(batch_size, n_channels, dim_1, , dim_{n_dims})</p></li>
<li><p><strong>image_2</strong>  Image registered to image_1, Tensor with shape
(batch_size, n_channels, dim_1, , dim_{n_dims})</p></li>
<li><p><strong>deformations_for_levels</strong>  Defines for which resolution levels the
deformations are returned. The first element of each tuple is
the index of the level and the second element indicates whether
to include affine transformation in the deformation. Indexing
starts from the highest resolution. Default value is [(0, True)]
which corresponds to returning the full deformation at the
highest resolution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of MappingPairs in the order given by the input argument
mappings_for_levels</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MIR.models.SITReg.image_coordinate_system">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_coordinate_system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CoordinateSystem</span></em><a class="headerlink" href="#MIR.models.SITReg.image_coordinate_system" title="Permalink to this definition"></a></dt>
<dd><p>Coordinate system used by the network for the inputs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MIR.models.SITReg.transformation_coordinate_system">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformation_coordinate_system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CoordinateSystem</span></em><a class="headerlink" href="#MIR.models.SITReg.transformation_coordinate_system" title="Permalink to this definition"></a></dt>
<dd><p>Coordinate system used by the predicted transformations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SSLHead1Lvl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SSLHead1Lvl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHead1Lvl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHead1Lvl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Self-supervised learning head with one level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder</strong>  Encoder model.</p></li>
<li><p><strong>img_size</strong>  Image size.</p></li>
<li><p><strong>num_lvls</strong>  Number of levels.</p></li>
<li><p><strong>channels</strong>  Number of channels per level.</p></li>
<li><p><strong>if_upsamp</strong>  Whether to upsample predicted flows.</p></li>
<li><p><strong>encoder_output_type</strong>  Encoder output type (single or multi).</p></li>
<li><p><strong>swap_encoder_order</strong>  Whether to swap encoder output order.</p></li>
<li><p><strong>gen_output</strong>  Whether to generate deformed output.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>inputs: Tuple <cite>(mov, fix)</cite> tensors.</p>
</dd>
<dt>Forward outputs:</dt><dd><p>If <cite>gen_output</cite>, returns <cite>(warped, flow)</cite>; otherwise <cite>flow</cite>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SSLHead1Lvl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHead1Lvl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHead1Lvl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run SSL head forward pass.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SSLHeadNLvl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SSLHeadNLvl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHeadNLvl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHeadNLvl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Self-supervised learning head with multiple levels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder</strong>  Encoder model.</p></li>
<li><p><strong>img_size</strong>  Image size.</p></li>
<li><p><strong>num_lvls</strong>  Number of levels.</p></li>
<li><p><strong>channels</strong>  Number of channels per level.</p></li>
<li><p><strong>if_upsamp</strong>  Whether to upsample predicted flows.</p></li>
<li><p><strong>encoder_output_type</strong>  Encoder output type (single or multi).</p></li>
<li><p><strong>encoder_input_type</strong>  Encoder input type (single, multi, or separate).</p></li>
<li><p><strong>swap_encoder_order</strong>  Whether to swap encoder output order.</p></li>
<li><p><strong>gen_output</strong>  Whether to generate deformed output.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>inputs: Tuple <cite>(mov, fix)</cite> tensors.</p>
</dd>
<dt>Forward outputs:</dt><dd><p>If <cite>gen_output</cite>, returns <cite>(warped, flow, stats)</cite>; otherwise <cite>(flow, stats)</cite>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SSLHeadNLvl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHeadNLvl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHeadNLvl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run SSL head forward pass.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SpatialTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SpatialTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#SpatialTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SpatialTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>N-D Spatial Transformer
Obtained from <a class="reference external" href="https://github.com/voxelmorph/voxelmorph">https://github.com/voxelmorph/voxelmorph</a>
:param size: spatial size of the input tensor
:param mode: interpolation mode, bilinear or nearest</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SpatialTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#SpatialTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SpatialTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Warp a source tensor with a displacement field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong>  Source tensor (B, C, ).</p></li>
<li><p><strong>flow</strong>  Displacement field (B, ndim, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Warped tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SwinTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl>
<dt>Swin Transformer</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>)  Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>)  Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>)  Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>)  Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>)  Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>)  Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>)  Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em>)  Window size. Default: 7</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>)  Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>)  If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>)  Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>)  Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>)  Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>)  Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>)  Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>)  If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>)  If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>)  Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer.init_weights" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer.train" title="Permalink to this definition"></a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SynthesisHead3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple synthesis head for 3D feature maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong>  Number of input channels.</p></li>
<li><p><strong>mid_channels</strong>  Number of intermediate channels.</p></li>
<li><p><strong>out_channels</strong>  Number of output channels.</p></li>
<li><p><strong>norm</strong>  Normalization type (instance or batch).</p></li>
<li><p><strong>activation</strong>  Activation function (leaky_relu or relu).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><p>x: Tensor of shape [B, C, D, H, W].</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor of shape [B, out_channels, D, H, W].</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply synthesis head.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3DAdvanced">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SynthesisHead3DAdvanced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3DAdvanced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3DAdvanced" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Synthesis head with residual and SE blocks for 3D features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong>  Number of input channels.</p></li>
<li><p><strong>mid_channels</strong>  Number of intermediate channels.</p></li>
<li><p><strong>num_res_blocks</strong>  Number of residual blocks.</p></li>
<li><p><strong>norm</strong>  Normalization type (instance or group).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><p>x: Tensor of shape [B, C, D, H, W].</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor of shape [B, 1, D, H, W].</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3DAdvanced.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3DAdvanced.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3DAdvanced.forward" title="Permalink to this definition"></a></dt>
<dd><p>Apply advanced synthesis head.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TemplateCreation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TemplateCreation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#TemplateCreation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TemplateCreation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Deformable Template Network
:param reg_model: Registration model
:param img_size: Image size
:param mean_cap: Mean cap for the MeanStream
:param use_sitreg: Use SITReg-style mapping outputs when True; VFA, TransMorph, VoxelMorph-style otherwise
:param mode: SpatialTransformer interpolation mode (SITReg path)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TemplateCreation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#TemplateCreation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TemplateCreation.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorph" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong>  Configuration object containing model parameters.</p></li>
<li><p><strong>SVF</strong>  Whether to integrate a stationary velocity field.</p></li>
<li><p><strong>SVF_steps</strong>  Number of scaling-and-squaring steps.</p></li>
<li><p><strong>swin_type</strong>  Transformer type (swin, dswin, dswinv2).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>inputs: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, D, H, W].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Dense flow tensor of shape [B, 3, D, H, W].</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorph.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorph.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorph.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorph model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong>  Tuple of moving and fixed images <cite>(mov, fix)</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted dense flow field.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorphAffine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphAffine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphAffine" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Affine TransMorph head predicting global parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong>  Configuration object containing model parameters.</p></li>
<li><p><strong>swin_type</strong>  Transformer type (swin, dswin, dswinv2).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>inputs: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, D, H, W].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Tuple <cite>(aff, scl, trans, shr)</cite> with rotation, scale, translation,
and shear parameters.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphAffine.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphAffine.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass predicting affine parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong>  Tuple of moving and fixed images <cite>(mov, fix)</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <cite>(aff, scl, trans, shr)</cite> of affine parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine.softplus">
<span class="sig-name descname"><span class="pre">softplus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphAffine.softplus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphAffine.softplus" title="Permalink to this definition"></a></dt>
<dd><p>Apply softplus activation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorphTVF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph TVF model with progressive flow integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong>  Configuration object containing model parameters.</p></li>
<li><p><strong>time_steps</strong>  Number of time steps for progressive registration.</p></li>
<li><p><strong>SVF</strong>  Whether to integrate a stationary velocity field.</p></li>
<li><p><strong>SVF_steps</strong>  Number of scaling-and-squaring steps.</p></li>
<li><p><strong>composition</strong>  Flow composition strategy (composition or addition).</p></li>
<li><p><strong>swin_type</strong>  Transformer type (swin, dswin, dswinv2).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>inputs: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, D, H, W].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Dense flow tensor of shape [B, 3, D, H, W].</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVF.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorphTVF model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong>  Tuple of moving and fixed images <cite>(mov, fix)</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted dense flow field.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVFSPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorphTVFSPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVFSPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVFSPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph TVF with spatially varying regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong>  Configuration object containing model parameters.</p></li>
<li><p><strong>time_steps</strong>  Number of time steps for progressive registration.</p></li>
<li><p><strong>SVF</strong>  Whether to integrate a stationary velocity field.</p></li>
<li><p><strong>SVF_steps</strong>  Number of scaling-and-squaring steps.</p></li>
<li><p><strong>composition</strong>  Flow composition strategy (composition or addition).</p></li>
<li><p><strong>swin_type</strong>  Transformer type (swin, dswin, dswinv2).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>inputs: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, D, H, W].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Tuple <cite>(flow, spatial_wts)</cite> where <cite>flow</cite> is [B, 3, D, H, W].</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVFSPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVFSPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVFSPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorphTVFSPR model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong>  Tuple of moving and fixed images <cite>(mov, fix)</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <cite>(flow, x_weight)</cite> or <cite>(pos_flow, neg_flow, x_weight)</cite> when
SVF is enabled.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransVFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransVFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransVFA.html#TransVFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransVFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransVFA model for image registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs_sw</strong>  Swin Transformer config.</p></li>
<li><p><strong>configs</strong>  VFA config.</p></li>
<li><p><strong>device</strong>  Device to run the model on.</p></li>
<li><p><strong>swin_type</strong>  Transformer type (swin, dswin, dswinv2).</p></li>
<li><p><strong>return_orginal</strong>  If True, return composed grids and stats.</p></li>
<li><p><strong>return_all_flows</strong>  If True, return flows for all decoder levels.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>sample: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, <a href="#id11"><span class="problematic" id="id12">*</span></a>spatial].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Flow(s) and optional auxiliary outputs depending on flags.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransVFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransVFA.html#TransVFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransVFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run forward registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output varies by flags (<cite>return_orginal</cite>, <cite>return_all_flows</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA model for image registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong>  VFA configuration object.</p></li>
<li><p><strong>device</strong>  Device to run the model on.</p></li>
<li><p><strong>return_orginal</strong>  If True, return VFA-style composed grids and stats.</p></li>
<li><p><strong>return_all_flows</strong>  If True, return flows for all decoder levels.</p></li>
<li><p><strong>SVF</strong>  If True, integrate flow as stationary velocity field.</p></li>
<li><p><strong>SVF_steps</strong>  Number of scaling-and-squaring steps for integration.</p></li>
<li><p><strong>return_full</strong>  If True, also return warped images and inverse flow.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>sample: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, <a href="#id13"><span class="problematic" id="id14">*</span></a>spatial].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Depending on flags, returns flow(s) or a results dict.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run forward registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output varies by flags (<cite>return_orginal</cite>, <cite>return_all_flows</cite>, <cite>SVF</cite>,
<cite>return_full</cite>). See class docstring for details.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VFASPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VFASPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFASPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFASPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA model with spatially varying regularization (VFA-SPR).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong>  VFA configuration object.</p></li>
<li><p><strong>device</strong>  Device to run the model on.</p></li>
<li><p><strong>return_orginal</strong>  If True, return VFA-style composed grids and stats.</p></li>
<li><p><strong>return_all_flows</strong>  If True, return flows for all decoder levels.</p></li>
<li><p><strong>SVF</strong>  If True, integrate flow as stationary velocity field.</p></li>
<li><p><strong>SVF_steps</strong>  Number of scaling-and-squaring steps for integration.</p></li>
<li><p><strong>return_full</strong>  If True, also return warped images and inverse flow.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Forward inputs:</dt><dd><p>sample: Tuple <cite>(mov, fix)</cite> tensors of shape [B, 1, <a href="#id15"><span class="problematic" id="id16">*</span></a>spatial].</p>
</dd>
<dt>Forward outputs:</dt><dd><p>Depending on flags, returns flow(s), spatial weights, or a results dict.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VFASPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFASPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFASPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run forward registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output varies by flags (<cite>return_orginal</cite>, <cite>return_all_flows</cite>, <cite>SVF</cite>,
<cite>return_full</cite>). See class docstring for details.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VecInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VecInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#VecInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VecInt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Integrates a vector field via scaling and squaring.
:param inshape: shape of the input tensor
:param nsteps: number of integration steps</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VecInt.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#VecInt.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VecInt.forward" title="Permalink to this definition"></a></dt>
<dd><p>Integrate a vector field via scaling and squaring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vec</strong>  Velocity field tensor (B, ndim, ).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrated displacement field.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VxmDense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VxmDense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VoxelMorph.html#VxmDense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VxmDense" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VoxelMorph network for nonlinear image registration.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>input_imgs: Tuple <cite>(mov, fix)</cite> of tensors [B, 1, <a href="#id17"><span class="problematic" id="id18">*</span></a>spatial].</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flow tensor, and optionally warped image if <cite>gen_output</cite> is True.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VxmDense.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VoxelMorph.html#VxmDense.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VxmDense.forward" title="Permalink to this definition"></a></dt>
<dd><p>Run VoxelMorph forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_imgs</strong>  Tuple <cite>(mov, fix)</cite> tensors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flow tensor, and optionally warped moving image.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.Warp3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">Warp3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#Warp3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Warp3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Warp3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#Warp3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Warp3d.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_MIND">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_MIND</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_MIND.html#convex_adam_MIND"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_MIND" title="Permalink to this definition"></a></dt>
<dd><p>Coupled convex optimisation with adam instance optimisation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_MIND_SPR">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_MIND_SPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_MIND_SPR.html#convex_adam_MIND_SPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_MIND_SPR" title="Permalink to this definition"></a></dt>
<dd><p>Coupled convex optimisation with adam instance optimisation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_features">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_features.html#convex_adam_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_features" title="Permalink to this definition"></a></dt>
<dd><p>Coupled convex optimisation with adam instance optimisation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_seg_features">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_seg_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_nnUNet.html#convex_adam_seg_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_seg_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.ensemble_average">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ensemble_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#ensemble_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ensemble_average" title="Permalink to this definition"></a></dt>
<dd><p>Ensemble average of displacement fields or SVFs.
:param fields: list of displacement fields, each (<a href="#id19"><span class="problematic" id="id20">*</span></a>vol, ndims)
:param field_types: parallel list, svf or disp
:param weights: list of floats or None (defaults to equal)
:param nb_steps: number of integration steps for VecInt
:param iters: number of iterations for fit_warp_to_svf</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy displacement field (<a href="#id21"><span class="problematic" id="id22">*</span></a>vol, ndims) = exp( w_i v_i)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>disp_bar</p>
</dd>
</dl>
<p># assume you already have three predictions:
svf_A   = np.load(model_A_velocity.npy)    # (<a href="#id23"><span class="problematic" id="id24">*</span></a>vol, 3)
disp_B  = np.load(model_B_disp.npy)        # (<a href="#id25"><span class="problematic" id="id26">*</span></a>vol, 3)
disp_C  = np.load(model_C_disp.npy)</p>
<p>fields      = [svf_A, disp_B, disp_C]
field_types = [svf, disp, disp]
# e.g. let Dice on a small valset decide the weights
weights     = [0.45, 0.35, 0.20]</p>
<dl class="simple">
<dt>disp_mean = ensemble_average(</dt><dd><p>fields,
field_types,
weights,
nb_steps=7,          # same nsteps you used during training/inference
iters=150,           # iterations for fit_warp_to_svf on the disp fields</p>
</dd>
</dl>
<p>)</p>
<p># now warp any tensor (image, mask, logits) with the consensus deformation
vol_shape = disp_mean.shape[:-1]
transform = SpatialTransformer(vol_shape).cuda()         # if GPU used above
moving_img_t = torch.from_numpy(moving_img)[None, None].float().cuda()
disp_t = torch.from_numpy(disp_mean).permute(3,0,1,2)[None].float().cuda()
warped = transform(moving_img_t, disp_t)                 # (1,1,*vol)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.fit_warp_to_svf">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">fit_warp_to_svf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warp_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'warp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'disp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#fit_warp_to_svf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.fit_warp_to_svf" title="Permalink to this definition"></a></dt>
<dd><p>Fit a stationaryvelocity field v so that exp(v)  given displacement field.
Parameters mirror the original TF implementation.
<cite>warp</cite> shape: (<a href="#id27"><span class="problematic" id="id28">*</span></a>vol_shape, ndims)  (numpy array or torch tensor)
Returns: v as a numpy array of same shape.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorph3Lvl_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorph3Lvl_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorph3Lvl_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorph3Lvl_config" title="Permalink to this definition"></a></dt>
<dd><p>Return TransMorph 3-level config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphDWin3Lvl_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphDWin3Lvl_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphDWin3Lvl_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphDWin3Lvl_config" title="Permalink to this definition"></a></dt>
<dd><p>Return TransMorph 3-level config with dual-window attention.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphLarge_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphLarge_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphLarge_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphLarge_config" title="Permalink to this definition"></a></dt>
<dd><p>A Large TransMorph Network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphLrn_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphLrn_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphLrn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphLrn_config" title="Permalink to this definition"></a></dt>
<dd><p>TransMorph with Learnable Positional Embedding</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoConvSkip_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoConvSkip_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoConvSkip_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoConvSkip_config" title="Permalink to this definition"></a></dt>
<dd><p>No skip connections from convolution layers</p>
<p>Computational complexity:       577.34 GMac
Number of parameters:           63.56 M</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoRelativePosEmbd_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoRelativePosEmbd_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoRelativePosEmbd_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoRelativePosEmbd_config" title="Permalink to this definition"></a></dt>
<dd><p>Return TransMorph config without relative positional embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoSkip_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoSkip_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoSkip_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoSkip_config" title="Permalink to this definition"></a></dt>
<dd><p>No skip connections</p>
<p>Computational complexity:       639.93 GMac
Number of parameters:           58.4 M</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoTransSkip_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoTransSkip_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoTransSkip_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoTransSkip_config" title="Permalink to this definition"></a></dt>
<dd><p>No skip connections from Transformer blocks</p>
<p>Computational complexity:       639.93 GMac
Number of parameters:           58.4 M</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphRelativePosEmbdSimple_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphRelativePosEmbdSimple_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphRelativePosEmbdSimple_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphRelativePosEmbdSimple_config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphSin_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphSin_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphSin_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphSin_config" title="Permalink to this definition"></a></dt>
<dd><p>Return TransMorph config with sinusoidal positional embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphSmall_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphSmall_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphSmall_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphSmall_config" title="Permalink to this definition"></a></dt>
<dd><p>A Small TransMorph Network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphTiny_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphTiny_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphTiny_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphTiny_config" title="Permalink to this definition"></a></dt>
<dd><p>A Tiny TransMorph Network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorph_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorph_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorph_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorph_config" title="Permalink to this definition"></a></dt>
<dd><p>Return base TransMorph 4-level config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_ConvexAdam_MIND_brain_default_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_ConvexAdam_MIND_brain_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/convexAdam/configs_ConvexAdam_MIND.html#get_ConvexAdam_MIND_brain_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_ConvexAdam_MIND_brain_default_config" title="Permalink to this definition"></a></dt>
<dd><p>ConvexAdam MIND default config.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VFA_default_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VFA_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VFA.html#get_VFA_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VFA_default_config" title="Permalink to this definition"></a></dt>
<dd><p>VFA default config.
config.name: str, name of the model.
config.skip: int, skip certain displacement fields in the decoder.
config.initialize: float, initialize beta in the decoder.
config.downsamples: int, number of downsampling layers in the encoder.
config.start_channels: int, number of channels in the first layer of the encoder.
config.matching_channels: int, number of channels in the matching layer of the encoder.
config.int_steps: int, number of integration steps in the decoder.
config.affine: int, whether to use affine transformation in the decoder.
config.img_size: tuple, size of the input image.
config.in_channels: int, number of input channels.
config.max_channels: int, maximum number of channels in the encoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VXM_1_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VXM_1_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VoxelMorph.html#get_VXM_1_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VXM_1_config" title="Permalink to this definition"></a></dt>
<dd><p>Return VoxelMorph-1 config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VXM_BJ_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VXM_BJ_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VoxelMorph.html#get_VXM_BJ_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VXM_BJ_config" title="Permalink to this definition"></a></dt>
<dd><p>Return VoxelMorph-BJ config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VXM_default_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VXM_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VoxelMorph.html#get_VXM_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VXM_default_config" title="Permalink to this definition"></a></dt>
<dd><p>Return default VoxelMorph-2 config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_collections.ConfigDict with model hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.grid_to_flow">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">grid_to_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#grid_to_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.grid_to_flow" title="Permalink to this definition"></a></dt>
<dd><p>Convert an absolute sampling grid (as produced by VFA) to a
voxeldisplacement field that VoxelMorphs SpatialTransformer expects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grid</strong>  Tensor of shape [B, ndim, <a href="#id29"><span class="problematic" id="id30">*</span></a>spatial_dims] with absolute coords.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of the same shape containing displacements from identity.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.invert_warp_via_velocity">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">invert_warp_via_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#invert_warp_via_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.invert_warp_via_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Approximate inverse by: fit v, then integrate v.
Returns a displacement field (numpy) of same shape.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.make_epoch_batches">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">make_epoch_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#make_epoch_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.make_epoch_batches" title="Permalink to this definition"></a></dt>
<dd><p>Create randomized batch index lists for one epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong>  Total number of samples.</p></li>
<li><p><strong>min_bs</strong>  Minimum batch size.</p></li>
<li><p><strong>max_bs</strong>  Maximum batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of numpy arrays of indices for each batch.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-MIR.utils"></span><p>Utility helpers for registration, training, visualization, and IO.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MIR.utils.AverageMeter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">AverageMeter</span></span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#AverageMeter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.AverageMeter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Computes and stores the average and current value</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.utils.AverageMeter.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#AverageMeter.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.AverageMeter.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset stored statistics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.utils.AverageMeter.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#AverageMeter.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.AverageMeter.update" title="Permalink to this definition"></a></dt>
<dd><p>Update running statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong>  New value.</p></li>
<li><p><strong>n</strong>  Weight/count for the value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.utils.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#Logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.Logger" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.utils.Logger.flush">
<span class="sig-name descname"><span class="pre">flush</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#Logger.flush"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.Logger.flush" title="Permalink to this definition"></a></dt>
<dd><p>No-op flush for compatibility with file-like interfaces.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.utils.Logger.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#Logger.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.Logger.write" title="Permalink to this definition"></a></dt>
<dd><p>Write a message to both stdout and the log file.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.utils.MultiResPatchSampler3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">MultiResPatchSampler3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#MultiResPatchSampler3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.MultiResPatchSampler3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.utils.RandomPatchSampler3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">RandomPatchSampler3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#RandomPatchSampler3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.RandomPatchSampler3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.SLANT_label_reassign">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">SLANT_label_reassign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/other_utils.html#SLANT_label_reassign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.SLANT_label_reassign" title="Permalink to this definition"></a></dt>
<dd><p>Reassign SLANT label IDs to contiguous indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label_map</strong>  Label map array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reassigned label map.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.utils.SpatialTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">SpatialTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/registration_utils.html#SpatialTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.SpatialTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>N-D Spatial Transformer
Obtained from <a class="reference external" href="https://github.com/voxelmorph/voxelmorph">https://github.com/voxelmorph/voxelmorph</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.utils.SpatialTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/registration_utils.html#SpatialTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.SpatialTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Warp a source image with a displacement field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong>  Source tensor (B, C, ).</p></li>
<li><p><strong>flow</strong>  Displacement field (B, ndim, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Warped source tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.utils.VecInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">VecInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/registration_utils.html#VecInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.VecInt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Integrates a vector field via scaling and squaring.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.utils.VecInt.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/registration_utils.html#VecInt.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.VecInt.forward" title="Permalink to this definition"></a></dt>
<dd><p>Integrate a vector field via scaling and squaring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vec</strong>  Velocity field tensor (B, ndim, ).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrated displacement field.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.get_cmap">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">get_cmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nipy_spectral'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/visualization_utils.html#get_cmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.get_cmap" title="Permalink to this definition"></a></dt>
<dd><p>Return a matplotlib colormap with n distinct colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong>  Number of discrete colors.</p></li>
<li><p><strong>name</strong>  Matplotlib colormap name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Colormap instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.load_partial_weights">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">load_partial_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'state_dict'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/other_utils.html#load_partial_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.load_partial_weights" title="Permalink to this definition"></a></dt>
<dd><p>Load weights from a checkpoint into a model, skipping unmatched layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>)  Your model with updated architecture.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em>)  Path to the .pth or .pt file.</p></li>
<li><p><strong>strict</strong> (<em>bool</em>)  If True, behaves like standard strict loading. If False, loads what it can.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.make_affine_from_pixdim">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">make_affine_from_pixdim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixdim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/registration_utils.html#make_affine_from_pixdim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.make_affine_from_pixdim" title="Permalink to this definition"></a></dt>
<dd><p>Create a 4x4 affine matrix from pixel spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pixdim</strong>  Sequence of spacing values (dx, dy, dz).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>4x4 affine matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.mk_grid_img">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">mk_grid_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(160,</span> <span class="pre">192,</span> <span class="pre">224)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/visualization_utils.html#mk_grid_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.mk_grid_img" title="Permalink to this definition"></a></dt>
<dd><p>Create a grid image tensor for visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_step</strong>  Spacing between grid lines.</p></li>
<li><p><strong>line_thickness</strong>  Grid line thickness.</p></li>
<li><p><strong>grid_sz</strong>  Grid size (H, W, D).</p></li>
<li><p><strong>dim</strong>  Axis along which to draw the grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Grid tensor with shape (1, 1, H, W, D).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.pad_image">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">pad_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/training_utils.html#pad_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.pad_image" title="Permalink to this definition"></a></dt>
<dd><p>Pad a 3D tensor to a target size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong>  Input tensor (B, C, H, W, D).</p></li>
<li><p><strong>target_size</strong>  Target spatial size (H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.pkload">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">pkload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/other_utils.html#pkload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.pkload" title="Permalink to this definition"></a></dt>
<dd><p>Load a pickled object from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong>  Path to pickle file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.resample_to_orginal_space_and_save">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">resample_to_orginal_space_and_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deformed_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ants_affine_mat_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_orig_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_back_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_pixdim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolater</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearestNeighbor'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/registration_utils.html#resample_to_orginal_space_and_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.resample_to_orginal_space_and_save" title="Permalink to this definition"></a></dt>
<dd><p>Resample a deformed image back to the original image space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deformed_img</strong>  Deformed image tensor (B, 1, H, W, D).</p></li>
<li><p><strong>ants_affine_mat_path</strong>  Path to the ANTs affine matrix.</p></li>
<li><p><strong>img_orig_path</strong>  Path to the original image (.nii.gz).</p></li>
<li><p><strong>out_back_dir</strong>  Output directory to save the resampled image.</p></li>
<li><p><strong>img_pixdim</strong>  Pixel spacing used during preprocessing.</p></li>
<li><p><strong>if_flip</strong>  Whether to flip the image along the specified axis.</p></li>
<li><p><strong>flip_axis</strong>  Axis along which to flip the image if if_flip is True.</p></li>
<li><p><strong>interpolater</strong>  ANTs interpolator (linear, nearestNeighbor, bSpline).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled image in the original space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>img_final</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.savepkl">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">savepkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/other_utils.html#savepkl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.savepkl" title="Permalink to this definition"></a></dt>
<dd><p>Save an object to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong>  Object to serialize.</p></li>
<li><p><strong>path</strong>  Output pickle file path.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.sliding_window_inference">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">sliding_window_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">133</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'argmax'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/utils/segmentation_utils.html#sliding_window_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.sliding_window_inference" title="Permalink to this definition"></a></dt>
<dd><p>Run sliding-window inference on a full-resolution feature volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong>  Feature tensor (B, C, H, W, D).</p></li>
<li><p><strong>head</strong>  Segmentation head that outputs logits.</p></li>
<li><p><strong>patch_size</strong>  Patch size (ph, pw, pd).</p></li>
<li><p><strong>overlap</strong>  Overlap ratio between patches.</p></li>
<li><p><strong>num_classes</strong>  Number of output classes.</p></li>
<li><p><strong>mode</strong>  Output mode (currently argmax).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Segmentation prediction (B, 1, H, W, D).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.write2csv">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">write2csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/other_utils.html#write2csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.write2csv" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.utils.zoom_img">
<span class="sig-prename descclassname"><span class="pre">MIR.utils.</span></span><span class="sig-name descname"><span class="pre">zoom_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/utils/other_utils.html#zoom_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.utils.zoom_img" title="Permalink to this definition"></a></dt>
<dd><p>Resize a 3D image to match target pixel dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong>  Input 3D image array.</p></li>
<li><p><strong>pixel_dims</strong>  Target spacing.</p></li>
<li><p><strong>order</strong>  Interpolation order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resampled image array.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-MIR.image_similarity"></span><p>Image similarity losses and metrics used in MIR registration.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.CompRecon">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">CompRecon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/CompositeRecon.html#CompRecon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.CompRecon" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Composite loss for image synthesis without GANs:</dt><dd><ul class="simple">
<li><p>Charbonnier (smooth L1) to preserve edges</p></li>
<li><p>Gradient-difference to align edges</p></li>
<li><p>Focal-frequency to boost high-frequency detail</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>charb_weight</strong> (<em>float</em>)  Weight for Charbonnier loss.</p></li>
<li><p><strong>grad_weight</strong> (<em>float</em>)  Weight for gradient difference loss.</p></li>
<li><p><strong>ff_weight</strong> (<em>float</em>)  Weight for focal frequency loss.</p></li>
<li><p><strong>eps</strong> (<em>float</em>)  Small constant to avoid division by zero.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>)  Exponent for focal frequency loss.</p></li>
<li><p><strong>beta</strong> (<em>float</em>)  Exponent for focal frequency loss.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.CompRecon.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/image_similarity/CompositeRecon.html#CompRecon.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.CompRecon.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute composite reconstruction loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong>  Predicted image tensor.</p></li>
<li><p><strong>target</strong>  Target image tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.CorrRatio">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">CorrRatio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#CorrRatio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.CorrRatio" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Correlation Ratio based on Parzen window
Implemented by Junyu Chen, <a class="reference external" href="mailto:jchen245&#37;&#52;&#48;jhmi&#46;edu">jchen245<span>&#64;</span>jhmi<span>&#46;</span>edu</a>
TODO: Under testing</p>
<p>The Correlation Ratio as a New Similarity Measure for Multimodal Image Registration
by Roche et al. 1998
<a class="reference external" href="https://link.springer.com/chapter/10.1007/BFb0056301">https://link.springer.com/chapter/10.1007/BFb0056301</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.CorrRatio.correlation_ratio">
<span class="sig-name descname"><span class="pre">correlation_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#CorrRatio.correlation_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.CorrRatio.correlation_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Compute correlation ratio between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong>  Image tensor (B, C, H, W, D).</p></li>
<li><p><strong>Y</strong>  Image tensor (B, C, H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar correlation ratio.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.CorrRatio.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#CorrRatio.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.CorrRatio.forward" title="Permalink to this definition"></a></dt>
<dd><p>Return negative symmetric correlation ratio as a loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.CorrRatio.gaussian_kernel">
<span class="sig-name descname"><span class="pre">gaussian_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preterm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#CorrRatio.gaussian_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.CorrRatio.gaussian_kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.image_similarity.CorrRatio.vol_bin_centers">
<span class="sig-name descname"><span class="pre">vol_bin_centers</span></span><a class="headerlink" href="#MIR.image_similarity.CorrRatio.vol_bin_centers" title="Permalink to this definition"></a></dt>
<dd><p>Sigma for Gaussian approx.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.DiceLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">DiceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Dice.html#DiceLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.DiceLoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Dice loss</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.DiceLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Dice.html#DiceLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.DiceLoss.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute Dice loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted probabilities (B, C, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Integer labels (B, 1, H, W, D) or (B, H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar Dice loss.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.DiceSegLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">DiceSegLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Segmentation_Overlap.html#DiceSegLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.DiceSegLoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.DiceSegLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/image_similarity/Segmentation_Overlap.html#DiceSegLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.DiceSegLoss.forward" title="Permalink to this definition"></a></dt>
<dd><p>logits: (B, C, ph, pw, pd)  raw scores
target: (B, ph, pw, pd)     integer labels in [0..C-1]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.FastNCC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">FastNCC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#FastNCC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.FastNCC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local (over window) normalized cross correlation loss by XiJia
<a class="reference external" href="https://github.com/xi-jia/FastLNCC">https://github.com/xi-jia/FastLNCC</a></p>
<p># For PyTorch versions &gt; 2.0, if there are numerical differences, please add the following code.
torch.backends.cudnn.allow_tf32 = False</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.FastNCC.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#FastNCC.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.FastNCC.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.LocalCorrRatio">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">LocalCorrRatio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#LocalCorrRatio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.LocalCorrRatio" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Localized Correlation Ratio based on Parzen window
Implemented by Junyu Chen, <a class="reference external" href="mailto:jchen245&#37;&#52;&#48;jhmi&#46;edu">jchen245<span>&#64;</span>jhmi<span>&#46;</span>edu</a>
TODO: Under testing</p>
<p>The Correlation Ratio as a New Similarity Measure for Multimodal Image Registration
by Roche et al. 1998
<a class="reference external" href="https://link.springer.com/chapter/10.1007/BFb0056301">https://link.springer.com/chapter/10.1007/BFb0056301</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.LocalCorrRatio.correlation_ratio">
<span class="sig-name descname"><span class="pre">correlation_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#LocalCorrRatio.correlation_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.LocalCorrRatio.correlation_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Compute local correlation ratio between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong>  Image tensor (B, C, H, W, D).</p></li>
<li><p><strong>Y</strong>  Image tensor (B, C, H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar correlation ratio.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.LocalCorrRatio.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#LocalCorrRatio.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.LocalCorrRatio.forward" title="Permalink to this definition"></a></dt>
<dd><p>Return negative symmetric local correlation ratio as a loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.LocalCorrRatio.gaussian_kernel">
<span class="sig-name descname"><span class="pre">gaussian_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preterm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Correlation_Ratio.html#LocalCorrRatio.gaussian_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.LocalCorrRatio.gaussian_kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.image_similarity.LocalCorrRatio.vol_bin_centers">
<span class="sig-name descname"><span class="pre">vol_bin_centers</span></span><a class="headerlink" href="#MIR.image_similarity.LocalCorrRatio.vol_bin_centers" title="Permalink to this definition"></a></dt>
<dd><p>Sigma for Gaussian approx.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.MIND_loss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">MIND_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/MIND_SSC.html#MIND_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MIND_loss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local (over window) normalized cross correlation loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.MIND_loss.MINDSSC">
<span class="sig-name descname"><span class="pre">MINDSSC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/MIND_SSC.html#MIND_loss.MINDSSC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MIND_loss.MINDSSC" title="Permalink to this definition"></a></dt>
<dd><p>Compute the MIND-SSC descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong>  Image tensor (B, 1, H, W, D).</p></li>
<li><p><strong>radius</strong>  Patch radius.</p></li>
<li><p><strong>dilation</strong>  Neighborhood dilation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MIND-SSC descriptor tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.MIND_loss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/MIND_SSC.html#MIND_loss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MIND_loss.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute MIND-SSC L2 loss between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.MIND_loss.pdist_squared">
<span class="sig-name descname"><span class="pre">pdist_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/MIND_SSC.html#MIND_loss.pdist_squared"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MIND_loss.pdist_squared" title="Permalink to this definition"></a></dt>
<dd><p>Compute pairwise squared distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong>  Tensor (B, N, D).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pairwise squared distances (B, N, N).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.MutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">MutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Mutual_Information.html#MutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MutualInformation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Mutual Information</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.MutualInformation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Mutual_Information.html#MutualInformation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MutualInformation.forward" title="Permalink to this definition"></a></dt>
<dd><p>Return negative mutual information as a loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.MutualInformation.mi">
<span class="sig-name descname"><span class="pre">mi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Mutual_Information.html#MutualInformation.mi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.MutualInformation.mi" title="Permalink to this definition"></a></dt>
<dd><p>Compute mutual information between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar mutual information.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local (over window) normalized cross correlation loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute NCC loss over a local window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar NCC loss (negative mean NCC).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_fp16">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC_fp16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_fp16"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_fp16" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local normalized crosscorrelation loss for 1, 2 or 3D inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>win</strong> (<em>int</em>)  Side length of the cubic averaging window.  Default: 9.</p></li>
<li><p><strong>squared</strong> (<em>bool</em>)  <ul>
<li><p>False   classic NCC   ( _xy / (_x _y) )</p></li>
<li><p>True    squared NCC   ( _xy / (_x _y) )</p></li>
</ul>
<p>Default: False.</p>
</p></li>
<li><p><strong>eps</strong> (<em>float</em>)  Small constant to avoid dividebyzero.  Default: 1e5.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_fp16.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_fp16.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_fp16.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_gauss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC_gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_gauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_gauss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local (over window) normalized cross correlation loss via Gaussian</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_gauss.create_window_3D">
<span class="sig-name descname"><span class="pre">create_window_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_gauss.create_window_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_gauss.create_window_3D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_gauss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_gauss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_gauss.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute Gaussian-windowed NCC loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar NCC loss (negative mean NCC).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_gauss.gaussian">
<span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_gauss.gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_gauss.gaussian" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_mok">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC_mok</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_mok"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_mok" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>local (over window) normalized cross correlation</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_mok.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_mok.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_mok.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_mok2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC_mok2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_mok2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_mok2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>local (over window) normalized cross correlation</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_mok2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_mok2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_mok2.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_vfa">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC_vfa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_vfa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_vfa" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Multi-scale NCC from C2FViT: <a class="reference external" href="https://github.com/cwmok/C2FViT">https://github.com/cwmok/C2FViT</a>
suitable for FP16</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_vfa.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_vfa.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_vfa.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_vxm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">NCC_vxm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_vxm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_vxm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local (over window) normalized cross correlation loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.NCC_vxm.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/NCC.html#NCC_vxm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.NCC_vxm.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.PCC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">PCC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/PCC.html#PCC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.PCC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.PCC.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/PCC.html#PCC.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.PCC.forward" title="Permalink to this definition"></a></dt>
<dd><p>Return 1 - PCC as a loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>J</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.PCC.pcc">
<span class="sig-name descname"><span class="pre">pcc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/PCC.html#PCC.pcc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.PCC.pcc" title="Permalink to this definition"></a></dt>
<dd><p>Compute Pearson correlation coefficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar PCC.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.SSIM2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">SSIM2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#SSIM2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.SSIM2D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.SSIM2D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#SSIM2D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.SSIM2D.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute 2D SSIM between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong>  Tensor (B, C, H, W).</p></li>
<li><p><strong>img2</strong>  Tensor (B, C, H, W).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SSIM score.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.SSIM3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">SSIM3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#SSIM3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.SSIM3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.SSIM3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#SSIM3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.SSIM3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute 3D SSIM between two volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img1</strong>  Tensor (B, C, H, W, D).</p></li>
<li><p><strong>img2</strong>  Tensor (B, C, H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SSIM score.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.SegmentationLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">SegmentationLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Segmentation_Overlap.html#SegmentationLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.SegmentationLoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.SegmentationLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/MIR/image_similarity/Segmentation_Overlap.html#SegmentationLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.SegmentationLoss.forward" title="Permalink to this definition"></a></dt>
<dd><p>logits: (B, C, ph, pw, pd)
target: (B, ph, pw, pd)  ints in [0..C-1]</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.image_similarity.create_window">
<span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">create_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#create_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.create_window" title="Permalink to this definition"></a></dt>
<dd><p>Create a 2D SSIM window tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.image_similarity.create_window_3D">
<span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">create_window_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#create_window_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.create_window_3D" title="Permalink to this definition"></a></dt>
<dd><p>Create a 3D SSIM window tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.image_similarity.gaussian">
<span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Create a 1D Gaussian kernel for SSIM windows.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.image_similarity.localMutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">localMutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Mutual_Information.html#localMutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.localMutualInformation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local Mutual Information for non-overlapping patches</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.localMutualInformation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Mutual_Information.html#localMutualInformation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.localMutualInformation.forward" title="Permalink to this definition"></a></dt>
<dd><p>Return negative local mutual information as a loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.image_similarity.localMutualInformation.local_mi">
<span class="sig-name descname"><span class="pre">local_mi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/Mutual_Information.html#localMutualInformation.local_mi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.localMutualInformation.local_mi" title="Permalink to this definition"></a></dt>
<dd><p>Compute local mutual information over patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong>  Fixed image tensor (B, 1, ).</p></li>
<li><p><strong>y_pred</strong>  Moving image tensor (B, 1, ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar local mutual information.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.image_similarity.ssim">
<span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">ssim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#ssim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.ssim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.image_similarity.ssim3D">
<span class="sig-prename descclassname"><span class="pre">MIR.image_similarity.</span></span><span class="sig-name descname"><span class="pre">ssim3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/image_similarity/SSIM.html#ssim3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.image_similarity.ssim3D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<span class="target" id="module-MIR.deformation_regularizer"></span><p>Regularization terms for deformation fields and velocity models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">DisplacementRegularizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Compute displacement-field regularization energies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.compute_bending_energy">
<span class="sig-name descname"><span class="pre">compute_bending_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">displacement</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.compute_bending_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.compute_bending_energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute bending energy of a displacement field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>displacement</strong>  Tensor (B, 3, H, W, D).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar bending energy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.compute_gradient_norm">
<span class="sig-name descname"><span class="pre">compute_gradient_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">displacement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.compute_gradient_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.compute_gradient_norm" title="Permalink to this definition"></a></dt>
<dd><p>Compute L1/L2 gradient norm of a displacement field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>displacement</strong>  Tensor (B, 3, H, W, D).</p></li>
<li><p><strong>flag_l1</strong>  If True, uses L1 norm; otherwise L2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar gradient norm.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.gradient_dx">
<span class="sig-name descname"><span class="pre">gradient_dx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.gradient_dx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_dx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.gradient_dy">
<span class="sig-name descname"><span class="pre">gradient_dy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.gradient_dy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_dy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.gradient_dz">
<span class="sig-name descname"><span class="pre">gradient_dz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.gradient_dz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_dz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.DisplacementRegularizer.gradient_txyz">
<span class="sig-name descname"><span class="pre">gradient_txyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Txyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#DisplacementRegularizer.gradient_txyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.DisplacementRegularizer.gradient_txyz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.Grad2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">Grad2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#Grad2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.Grad2D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>2D gradient loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.Grad2D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#Grad2D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.Grad2D.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute 2D gradient regularization loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted displacement/field tensor (B, C, H, W).</p></li>
<li><p><strong>y_true</strong>  Unused placeholder for API compatibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar gradient penalty.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.Grad3DiTV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">Grad3DiTV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#Grad3DiTV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.Grad3DiTV" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>3D gradient Isotropic TV loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.Grad3DiTV.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#Grad3DiTV.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.Grad3DiTV.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute isotropic total-variation loss in 3D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted displacement/field tensor (B, C, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Unused placeholder for API compatibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar TV penalty.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.Grad3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">Grad3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#Grad3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.Grad3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>3D gradient loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.Grad3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#Grad3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.Grad3d.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute 3D gradient regularization loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted displacement/field tensor (B, C, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Unused placeholder for API compatibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar gradient penalty.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.GradICON3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">GradICON3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#GradICON3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.GradICON3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>GradientICON loss for 3D displacement fields.
Penalises the Frobeniusnorm of the Jacobian of the
composition ^{AB}^{BA} (forward  inverse).</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.GradICON3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow_fwd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_inv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#GradICON3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.GradICON3d.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loss</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar GradICON penalty</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.GradICONExact3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">GradICONExact3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#GradICONExact3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.GradICONExact3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Paperfaithful GradientICON for 3D flows</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.GradICONExact3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow_fwd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_inv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/GlobalRegularizers.html#GradICONExact3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.GradICONExact3d.forward" title="Permalink to this definition"></a></dt>
<dd><p>flow_fwd, flow_inv : (B,3,D,H,W) voxelunit displacements</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.KL_divergence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">KL_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/KL_divergence.html#KL_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.KL_divergence" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>KL divergence between factorized Gaussian fields.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.KL_divergence.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/KL_divergence.html#KL_divergence.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.KL_divergence.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute KL divergence between two Gaussian fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong>  Tuple (mean_p, log_sigma_p) tensors.</p></li>
<li><p><strong>Q</strong>  Tuple (mean_q, log_sigma_q) tensors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar KL divergence.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.LocalGrad3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">LocalGrad3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/LocalRegularizers.html#LocalGrad3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.LocalGrad3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Local 3D gradient loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.LocalGrad3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/LocalRegularizers.html#LocalGrad3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.LocalGrad3d.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute weighted 3D gradient regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted displacement/field tensor (B, C, H, W, D).</p></li>
<li><p><strong>weight</strong>  Spatial weight tensor (B, 1, H, W, D).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar weighted gradient penalty.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.MultiVariateKL_divergence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">MultiVariateKL_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/KL_divergence.html#MultiVariateKL_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.MultiVariateKL_divergence" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>KL divergence between multivariate Gaussian fields.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.MultiVariateKL_divergence.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/KL_divergence.html#MultiVariateKL_divergence.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.MultiVariateKL_divergence.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute multivariate KL divergence between Gaussian fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong>  Tuple (mean_p, log_sigma_p) tensors.</p></li>
<li><p><strong>Q</strong>  Tuple (mean_q, log_sigma_q) tensors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar KL divergence.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.logBeta">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">logBeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/LocalRegularizers.html#logBeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.logBeta" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Negative log-likelihood term for Beta prior on weights.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.logBeta.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/LocalRegularizers.html#logBeta.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.logBeta.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute Beta prior regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong>  Tensor of weights.</p></li>
<li><p><strong>alpha</strong>  Beta distribution alpha parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar regularization loss.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.logGaussian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.deformation_regularizer.</span></span><span class="sig-name descname"><span class="pre">logGaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/LocalRegularizers.html#logGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.logGaussian" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Gaussian prior regularizer for weights.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.deformation_regularizer.logGaussian.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_sigma2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/deformation_regularizer/LocalRegularizers.html#logGaussian.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.deformation_regularizer.logGaussian.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute Gaussian prior regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong>  Tensor of weights.</p></li>
<li><p><strong>inv_sigma2</strong>  Inverse variance scalar/tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar regularization loss.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-MIR.accuracy_measures"></span><p>Accuracy metrics and Jacobian-based measures for evaluation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.calc_J_i">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">calc_J_i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/digital_diffeomorphism.html#calc_J_i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.calc_J_i" title="Permalink to this definition"></a></dt>
<dd><p>Compute Jacobian determinant using a specific finite-difference stencil.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trans</strong>  Displacement field (3, H, W, D).</p></li>
<li><p><strong>grad_args</strong>  Gradient stencil spec (e.g., 0x0y0z, +x-y+z).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jacobian determinant volume (H-2, W-2, D-2).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.calc_Jstar_1">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">calc_Jstar_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/digital_diffeomorphism.html#calc_Jstar_1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.calc_Jstar_1" title="Permalink to this definition"></a></dt>
<dd><p>Compute Jacobian determinant with forward-difference stencil.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trans</strong>  Displacement field (3, H, W, D).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jacobian determinant volume (H-2, W-2, D-2).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.calc_Jstar_2">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">calc_Jstar_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/digital_diffeomorphism.html#calc_Jstar_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.calc_Jstar_2" title="Permalink to this definition"></a></dt>
<dd><p>Compute Jacobian determinant with backward-difference stencil.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trans</strong>  Displacement field (3, H, W, D).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jacobian determinant volume (H-2, W-2, D-2).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.calc_jac_dets">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">calc_jac_dets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/digital_diffeomorphism.html#calc_jac_dets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.calc_jac_dets" title="Permalink to this definition"></a></dt>
<dd><p>Compute multiple Jacobian determinant variants and consistency mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trans</strong>  Displacement field (3, H, W, D).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict of Jacobian determinant volumes keyed by stencil string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.calc_measurements">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">calc_measurements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jac_dets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/digital_diffeomorphism.html#calc_measurements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.calc_measurements" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.dice_val_VOI">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">dice_val_VOI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_clus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/acc_measures.html#dice_val_VOI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.dice_val_VOI" title="Permalink to this definition"></a></dt>
<dd><p>Compute mean Dice over a set of labels of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted label tensor (B, 1, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Ground-truth label tensor (B, 1, H, W, D).</p></li>
<li><p><strong>num_clus</strong>  Number of classes (used when eval_labels is None).</p></li>
<li><p><strong>eval_labels</strong>  Optional list/array of label IDs to evaluate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean Dice score across the selected labels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.dice_val_all">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">dice_val_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_clus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/acc_measures.html#dice_val_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.dice_val_all" title="Permalink to this definition"></a></dt>
<dd><p>Compute mean Dice across all classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted label tensor (B, 1, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Ground-truth label tensor (B, 1, H, W, D).</p></li>
<li><p><strong>num_clus</strong>  Number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar mean Dice across classes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.dice_val_substruct">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">dice_val_substruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">46</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/acc_measures.html#dice_val_substruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.dice_val_substruct" title="Permalink to this definition"></a></dt>
<dd><p>Compute per-class Dice scores and return as a CSV line string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong>  Predicted label tensor (B, 1, H, W, D).</p></li>
<li><p><strong>y_true</strong>  Ground-truth label tensor (B, 1, H, W, D).</p></li>
<li><p><strong>std_idx</strong>  Case identifier used in the output line.</p></li>
<li><p><strong>num_classes</strong>  Total number of classes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CSV line string with per-class Dice values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.accuracy_measures.get_identity_grid">
<span class="sig-prename descclassname"><span class="pre">MIR.accuracy_measures.</span></span><span class="sig-name descname"><span class="pre">get_identity_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/accuracy_measures/digital_diffeomorphism.html#get_identity_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.accuracy_measures.get_identity_grid" title="Permalink to this definition"></a></dt>
<dd><p>Return the identity transformation of the same size as the input.
Expect input dimension: 3xHxWxS.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quick_start.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api/MIR.models.html" class="btn btn-neutral float-right" title="MIR.models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>