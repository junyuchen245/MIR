

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; MIR 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=f6245a2f"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="MIR Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MIR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#MIR.RandomMultiContrastRemap"><code class="docutils literal notranslate"><span class="pre">RandomMultiContrastRemap</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.RandomMultiContrastRemap.forward"><code class="docutils literal notranslate"><span class="pre">RandomMultiContrastRemap.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.RandomMultiContrastRemap.training"><code class="docutils literal notranslate"><span class="pre">RandomMultiContrastRemap.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.affine_aug"><code class="docutils literal notranslate"><span class="pre">affine_aug()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.fill_holes_torch"><code class="docutils literal notranslate"><span class="pre">fill_holes_torch()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.flip_aug"><code class="docutils literal notranslate"><span class="pre">flip_aug()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.AdvancedDecoder3D"><code class="docutils literal notranslate"><span class="pre">AdvancedDecoder3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AdvancedDecoder3D.forward"><code class="docutils literal notranslate"><span class="pre">AdvancedDecoder3D.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AdvancedDecoder3D.training"><code class="docutils literal notranslate"><span class="pre">AdvancedDecoder3D.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.AffineTransformer"><code class="docutils literal notranslate"><span class="pre">AffineTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AffineTransformer.apply_affine"><code class="docutils literal notranslate"><span class="pre">AffineTransformer.apply_affine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AffineTransformer.forward"><code class="docutils literal notranslate"><span class="pre">AffineTransformer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.AffineTransformer.training"><code class="docutils literal notranslate"><span class="pre">AffineTransformer.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.Conv3dReLU"><code class="docutils literal notranslate"><span class="pre">Conv3dReLU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ConvNeXtSynthHead3D"><code class="docutils literal notranslate"><span class="pre">ConvNeXtSynthHead3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.ConvNeXtSynthHead3D.forward"><code class="docutils literal notranslate"><span class="pre">ConvNeXtSynthHead3D.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.ConvNeXtSynthHead3D.training"><code class="docutils literal notranslate"><span class="pre">ConvNeXtSynthHead3D.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.get_candidate_from_tensor"><code class="docutils literal notranslate"><span class="pre">Decoder.get_candidate_from_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.to_token"><code class="docutils literal notranslate"><span class="pre">Decoder.to_token()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Decoder.training"><code class="docutils literal notranslate"><span class="pre">Decoder.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DecoderBlock"><code class="docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DecoderBlock.forward"><code class="docutils literal notranslate"><span class="pre">DecoderBlock.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DecoderBlock.training"><code class="docutils literal notranslate"><span class="pre">DecoderBlock.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DefSwinTransformer"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.forward"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.init_weights"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.init_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.train"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformer.training"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformer.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.forward"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.init_weights"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.init_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.train"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DefSwinTransformerV2.training"><code class="docutils literal notranslate"><span class="pre">DefSwinTransformerV2.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.DoubleConv3d"><code class="docutils literal notranslate"><span class="pre">DoubleConv3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DoubleConv3d.forward"><code class="docutils literal notranslate"><span class="pre">DoubleConv3d.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.DoubleConv3d.training"><code class="docutils literal notranslate"><span class="pre">DoubleConv3d.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.EfficientAdvancedSynthHead3D"><code class="docutils literal notranslate"><span class="pre">EfficientAdvancedSynthHead3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EfficientAdvancedSynthHead3D.forward"><code class="docutils literal notranslate"><span class="pre">EfficientAdvancedSynthHead3D.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EfficientAdvancedSynthHead3D.training"><code class="docutils literal notranslate"><span class="pre">EfficientAdvancedSynthHead3D.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor.forward"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor.get_shapes"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor.get_shapes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.EncoderFeatureExtractor.training"><code class="docutils literal notranslate"><span class="pre">EncoderFeatureExtractor.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.GroupNet3D"><code class="docutils literal notranslate"><span class="pre">GroupNet3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.GroupNet3D.forward"><code class="docutils literal notranslate"><span class="pre">GroupNet3D.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.GroupNet3D.training"><code class="docutils literal notranslate"><span class="pre">GroupNet3D.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.GroupNormalizerFactory"><code class="docutils literal notranslate"><span class="pre">GroupNormalizerFactory</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.GroupNormalizerFactory.build"><code class="docutils literal notranslate"><span class="pre">GroupNormalizerFactory.build()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperTransMorphTVF"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVF</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperTransMorphTVF.forward"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVF.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperTransMorphTVF.training"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVF.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperTransMorphTVFSPR"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVFSPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperTransMorphTVFSPR.forward"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVFSPR.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperTransMorphTVFSPR.training"><code class="docutils literal notranslate"><span class="pre">HyperTransMorphTVFSPR.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperVFA"><code class="docutils literal notranslate"><span class="pre">HyperVFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVFA.forward"><code class="docutils literal notranslate"><span class="pre">HyperVFA.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVFA.training"><code class="docutils literal notranslate"><span class="pre">HyperVFA.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperVFASPR"><code class="docutils literal notranslate"><span class="pre">HyperVFASPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVFASPR.forward"><code class="docutils literal notranslate"><span class="pre">HyperVFASPR.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVFASPR.training"><code class="docutils literal notranslate"><span class="pre">HyperVFASPR.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.HyperVxmDense"><code class="docutils literal notranslate"><span class="pre">HyperVxmDense</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVxmDense.forward"><code class="docutils literal notranslate"><span class="pre">HyperVxmDense.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.HyperVxmDense.training"><code class="docutils literal notranslate"><span class="pre">HyperVxmDense.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ListBatchSampler"><code class="docutils literal notranslate"><span class="pre">ListBatchSampler</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.MappingPair"><code class="docutils literal notranslate"><span class="pre">MappingPair</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MappingPair.forward_mapping"><code class="docutils literal notranslate"><span class="pre">MappingPair.forward_mapping</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MappingPair.inverse_mapping"><code class="docutils literal notranslate"><span class="pre">MappingPair.inverse_mapping</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.MeanStream"><code class="docutils literal notranslate"><span class="pre">MeanStream</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MeanStream.forward"><code class="docutils literal notranslate"><span class="pre">MeanStream.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MeanStream.mean_update"><code class="docutils literal notranslate"><span class="pre">MeanStream.mean_update()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.MeanStream.training"><code class="docutils literal notranslate"><span class="pre">MeanStream.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ReLUFactory"><code class="docutils literal notranslate"><span class="pre">ReLUFactory</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.ReLUFactory.build"><code class="docutils literal notranslate"><span class="pre">ReLUFactory.build()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.RegistrationHead"><code class="docutils literal notranslate"><span class="pre">RegistrationHead</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SITReg"><code class="docutils literal notranslate"><span class="pre">SITReg</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.forward"><code class="docutils literal notranslate"><span class="pre">SITReg.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.image_coordinate_system"><code class="docutils literal notranslate"><span class="pre">SITReg.image_coordinate_system</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.training"><code class="docutils literal notranslate"><span class="pre">SITReg.training</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SITReg.transformation_coordinate_system"><code class="docutils literal notranslate"><span class="pre">SITReg.transformation_coordinate_system</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SSLHead1Lvl"><code class="docutils literal notranslate"><span class="pre">SSLHead1Lvl</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SSLHead1Lvl.forward"><code class="docutils literal notranslate"><span class="pre">SSLHead1Lvl.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SSLHead1Lvl.training"><code class="docutils literal notranslate"><span class="pre">SSLHead1Lvl.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SSLHeadNLvl"><code class="docutils literal notranslate"><span class="pre">SSLHeadNLvl</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SSLHeadNLvl.forward"><code class="docutils literal notranslate"><span class="pre">SSLHeadNLvl.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SSLHeadNLvl.training"><code class="docutils literal notranslate"><span class="pre">SSLHeadNLvl.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SpatialTransformer"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SpatialTransformer.forward"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SpatialTransformer.training"><code class="docutils literal notranslate"><span class="pre">SpatialTransformer.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SwinTransformer"><code class="docutils literal notranslate"><span class="pre">SwinTransformer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.forward"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.init_weights"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.init_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.train"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SwinTransformer.training"><code class="docutils literal notranslate"><span class="pre">SwinTransformer.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SynthesisHead3D"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3D</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SynthesisHead3D.forward"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3D.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SynthesisHead3D.training"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3D.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.SynthesisHead3DAdvanced"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3DAdvanced</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SynthesisHead3DAdvanced.forward"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3DAdvanced.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.SynthesisHead3DAdvanced.training"><code class="docutils literal notranslate"><span class="pre">SynthesisHead3DAdvanced.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TemplateCreation"><code class="docutils literal notranslate"><span class="pre">TemplateCreation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TemplateCreation.forward"><code class="docutils literal notranslate"><span class="pre">TemplateCreation.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TemplateCreation.training"><code class="docutils literal notranslate"><span class="pre">TemplateCreation.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorph"><code class="docutils literal notranslate"><span class="pre">TransMorph</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorph.forward"><code class="docutils literal notranslate"><span class="pre">TransMorph.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorph.training"><code class="docutils literal notranslate"><span class="pre">TransMorph.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorphAffine"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphAffine.forward"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphAffine.softplus"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine.softplus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphAffine.training"><code class="docutils literal notranslate"><span class="pre">TransMorphAffine.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorphTVF"><code class="docutils literal notranslate"><span class="pre">TransMorphTVF</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphTVF.forward"><code class="docutils literal notranslate"><span class="pre">TransMorphTVF.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphTVF.training"><code class="docutils literal notranslate"><span class="pre">TransMorphTVF.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransMorphTVFSPR"><code class="docutils literal notranslate"><span class="pre">TransMorphTVFSPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphTVFSPR.forward"><code class="docutils literal notranslate"><span class="pre">TransMorphTVFSPR.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransMorphTVFSPR.training"><code class="docutils literal notranslate"><span class="pre">TransMorphTVFSPR.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.TransVFA"><code class="docutils literal notranslate"><span class="pre">TransVFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransVFA.forward"><code class="docutils literal notranslate"><span class="pre">TransVFA.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.TransVFA.training"><code class="docutils literal notranslate"><span class="pre">TransVFA.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VFA"><code class="docutils literal notranslate"><span class="pre">VFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VFA.forward"><code class="docutils literal notranslate"><span class="pre">VFA.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VFA.training"><code class="docutils literal notranslate"><span class="pre">VFA.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VFASPR"><code class="docutils literal notranslate"><span class="pre">VFASPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VFASPR.forward"><code class="docutils literal notranslate"><span class="pre">VFASPR.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VFASPR.training"><code class="docutils literal notranslate"><span class="pre">VFASPR.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VecInt"><code class="docutils literal notranslate"><span class="pre">VecInt</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VecInt.forward"><code class="docutils literal notranslate"><span class="pre">VecInt.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VecInt.training"><code class="docutils literal notranslate"><span class="pre">VecInt.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.VxmDense"><code class="docutils literal notranslate"><span class="pre">VxmDense</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VxmDense.forward"><code class="docutils literal notranslate"><span class="pre">VxmDense.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.VxmDense.training"><code class="docutils literal notranslate"><span class="pre">VxmDense.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.Warp3d"><code class="docutils literal notranslate"><span class="pre">Warp3d</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Warp3d.forward"><code class="docutils literal notranslate"><span class="pre">Warp3d.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#MIR.models.Warp3d.training"><code class="docutils literal notranslate"><span class="pre">Warp3d.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_MIND"><code class="docutils literal notranslate"><span class="pre">convex_adam_MIND()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_MIND_SPR"><code class="docutils literal notranslate"><span class="pre">convex_adam_MIND_SPR()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_features"><code class="docutils literal notranslate"><span class="pre">convex_adam_features()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.convex_adam_seg_features"><code class="docutils literal notranslate"><span class="pre">convex_adam_seg_features()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.ensemble_average"><code class="docutils literal notranslate"><span class="pre">ensemble_average()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.fit_warp_to_svf"><code class="docutils literal notranslate"><span class="pre">fit_warp_to_svf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorph3Lvl_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorph3Lvl_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphDWin3Lvl_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphDWin3Lvl_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphLarge_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphLarge_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphLrn_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphLrn_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoConvSkip_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoConvSkip_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoRelativePosEmbd_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoRelativePosEmbd_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoSkip_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoSkip_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphNoTransSkip_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphNoTransSkip_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphRelativePosEmbdSimple_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphRelativePosEmbdSimple_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphSin_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphSin_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphSmall_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphSmall_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorphTiny_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorphTiny_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_3DTransMorph_config"><code class="docutils literal notranslate"><span class="pre">get_3DTransMorph_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_ConvexAdam_MIND_brain_default_config"><code class="docutils literal notranslate"><span class="pre">get_ConvexAdam_MIND_brain_default_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VFA_default_config"><code class="docutils literal notranslate"><span class="pre">get_VFA_default_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VXM_1_config"><code class="docutils literal notranslate"><span class="pre">get_VXM_1_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VXM_BJ_config"><code class="docutils literal notranslate"><span class="pre">get_VXM_BJ_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.get_VXM_default_config"><code class="docutils literal notranslate"><span class="pre">get_VXM_default_config()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.grid_to_flow"><code class="docutils literal notranslate"><span class="pre">grid_to_flow()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.invert_warp_via_velocity"><code class="docutils literal notranslate"><span class="pre">invert_warp_via_velocity()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#MIR.models.make_epoch_batches"><code class="docutils literal notranslate"><span class="pre">make_epoch_batches()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MIR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-MIR">
<span id="api-reference"></span><h1>API Reference<a class="headerlink" href="#module-MIR" title="Permalink to this heading"></a></h1>
<p>Auto-generated on 2025-05-01 – edit as needed.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MIR.RandomMultiContrastRemap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.</span></span><span class="sig-name descname"><span class="pre">RandomMultiContrastRemap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['t2',</span> <span class="pre">'flair',</span> <span class="pre">'t2star',</span> <span class="pre">'pd',</span> <span class="pre">'ct',</span> <span class="pre">'random_remap',</span> <span class="pre">'random_lut']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/data_augmentation.html#RandomMultiContrastRemap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.RandomMultiContrastRemap" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Augment a skull‑stripped T1‑w brain MRI so that the same anatomy can resemble
T2, FLAIR, T2*, or CT.  Background stays zero; brain voxels are re‑normalized
to [0,1] at the end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – Probability of applying the augmentation</p></li>
<li><p><strong>noise_std</strong> – Standard deviation of Gaussian noise added to the image</p></li>
<li><p><strong>downsample_p</strong> – Probability of applying simulated coarse width resolution</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.RandomMultiContrastRemap.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/data_augmentation.html#RandomMultiContrastRemap.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.RandomMultiContrastRemap.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.RandomMultiContrastRemap.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.RandomMultiContrastRemap.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.affine_aug">
<span class="sig-prename descclassname"><span class="pre">MIR.</span></span><span class="sig-name descname"><span class="pre">affine_aug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/data_augmentation.html#affine_aug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.affine_aug" title="Permalink to this definition"></a></dt>
<dd><p>Random affine transformation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.fill_holes_torch">
<span class="sig-prename descclassname"><span class="pre">MIR.</span></span><span class="sig-name descname"><span class="pre">fill_holes_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closing_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">BoolTensor</span></span></span><a class="reference internal" href="_modules/MIR/data_augmentation.html#fill_holes_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.fill_holes_torch" title="Permalink to this definition"></a></dt>
<dd><p>Remove small gaps and fill internal holes in a 3D brain mask.</p>
<p>Steps:
1. Closing (dilation followed by erosion) with a cubic kernel of <cite>closing_size</cite>
2. Invert the closed mask to get ‘holes + background’
3. Flood-fill from the border (repeated dilation masked by inverted mask)
4. The remaining True in inverted mask are true holes; add them back to closed mask.</p>
<p>mask: (D,H,W) bool tensor
closing_size: odd int, kernel size of the closing operation
returns: bool tensor (D,H,W) with holes filled</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.flip_aug">
<span class="sig-prename descclassname"><span class="pre">MIR.</span></span><span class="sig-name descname"><span class="pre">flip_aug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_label_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_label_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/data_augmentation.html#flip_aug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.flip_aug" title="Permalink to this definition"></a></dt>
<dd><p>Flip the image along random axis</p>
</dd></dl>

<span class="target" id="module-MIR.models"></span><p>Auto-generated on 2025-05-01 – edit as needed.</p>
<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.AdvancedDecoder3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">AdvancedDecoder3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspp_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">133</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Segmentation_Heads.html#AdvancedDecoder3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AdvancedDecoder3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Advanced 3D decoder for multi-resolution encoder features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder_channels</strong> – list of channel counts for each x_feats[i]</p></li>
<li><p><strong>aspp_out</strong> – number of channels after ASPP</p></li>
<li><p><strong>num_classes</strong> – number of output classes (e.g. 133)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.AdvancedDecoder3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_feats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Segmentation_Heads.html#AdvancedDecoder3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AdvancedDecoder3D.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>x_feats: list of length L with</dt><dd><p>x_feats[i].shape == (B, encoder_channels[i], Di, Hi, Wi)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>logits (B, num_classes, D0, H0, W0)  at the highest resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.AdvancedDecoder3D.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.AdvancedDecoder3D.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">AffineTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#AffineTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AffineTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>3-D Affine Transformer
:param mode: interpolation mode, ‘bilinear’ or ‘nearest’</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer.apply_affine">
<span class="sig-name descname"><span class="pre">apply_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#AffineTransformer.apply_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AffineTransformer.apply_affine" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#AffineTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.AffineTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.AffineTransformer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.AffineTransformer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.Conv3dReLU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">Conv3dReLU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batchnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#Conv3dReLU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Conv3dReLU" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequential</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.ConvNeXtSynthHead3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ConvNeXtSynthHead3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#ConvNeXtSynthHead3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ConvNeXtSynthHead3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.ConvNeXtSynthHead3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#ConvNeXtSynthHead3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ConvNeXtSynthHead3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (B, C, H, W, D)
returns: (B, 1, H, W, D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.ConvNeXtSynthHead3D.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.ConvNeXtSynthHead3D.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.Decoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">Decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA decoder network</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Decoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Decoder.get_candidate_from_tensor">
<span class="sig-name descname"><span class="pre">get_candidate_from_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder.get_candidate_from_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder.get_candidate_from_tensor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Decoder.to_token">
<span class="sig-name descname"><span class="pre">to_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#Decoder.to_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Decoder.to_token" title="Permalink to this definition"></a></dt>
<dd><p>flatten the spatial dimensions and put the channel dimension to the end</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.Decoder.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.Decoder.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DecoderBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DecoderBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batchnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#DecoderBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DecoderBlock" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DecoderBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#DecoderBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DecoderBlock.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.DecoderBlock.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.DecoderBlock.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DefSwinTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrain_img_size=224,</span> <span class="pre">patch_size=4,</span> <span class="pre">in_chans=3,</span> <span class="pre">embed_dim=96,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">6,</span> <span class="pre">2],</span> <span class="pre">num_heads=[3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24],</span> <span class="pre">window_size=(7,</span> <span class="pre">7,</span> <span class="pre">7),</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.2,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">ape=False,</span> <span class="pre">spe=False,</span> <span class="pre">rpe=True,</span> <span class="pre">patch_norm=True,</span> <span class="pre">out_indices=(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">frozen_stages=-1,</span> <span class="pre">use_checkpoint=False,</span> <span class="pre">pat_merg_rf=2,</span> <span class="pre">img_size=(160,</span> <span class="pre">160,</span> <span class="pre">160),</span> <span class="pre">dwin_size=(3,</span> <span class="pre">3,</span> <span class="pre">3)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl>
<dt>Swin Transformer</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>) – Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>) – Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em>) – Window size. Default: 7</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>) – Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>) – Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>) – Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>) – Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>) – Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>) – If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>) – If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>) – Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer.init_weights" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer.html#DefSwinTransformer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformer.train" title="Permalink to this definition"></a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.DefSwinTransformer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DefSwinTransformerV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrain_img_size=224,</span> <span class="pre">patch_size=4,</span> <span class="pre">in_chans=3,</span> <span class="pre">embed_dim=96,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">6,</span> <span class="pre">2],</span> <span class="pre">num_heads=[3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24],</span> <span class="pre">window_size=(7,</span> <span class="pre">7,</span> <span class="pre">7),</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.2,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">ape=False,</span> <span class="pre">spe=False,</span> <span class="pre">rpe=True,</span> <span class="pre">patch_norm=True,</span> <span class="pre">out_indices=(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">frozen_stages=-1,</span> <span class="pre">use_checkpoint=False,</span> <span class="pre">pat_merg_rf=2,</span> <span class="pre">img_size=(160,</span> <span class="pre">160,</span> <span class="pre">160),</span> <span class="pre">dwin_size=(3,</span> <span class="pre">3,</span> <span class="pre">3)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl>
<dt>Deformable Swin Transformer</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>) – Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>) – Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em>) – Window size. Default: 7</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>) – Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>) – Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>) – Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>) – Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>) – Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>) – If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>) – If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>) – Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.init_weights" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Deformable_Swin_Transformer_v2.html#DefSwinTransformerV2.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.train" title="Permalink to this definition"></a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.DefSwinTransformerV2.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.DefSwinTransformerV2.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.DoubleConv3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">DoubleConv3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#DoubleConv3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DoubleConv3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.DoubleConv3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#DoubleConv3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.DoubleConv3d.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.DoubleConv3d.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.DoubleConv3d.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.EfficientAdvancedSynthHead3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">EfficientAdvancedSynthHead3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#EfficientAdvancedSynthHead3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EfficientAdvancedSynthHead3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Memory-efficient advanced synthesis head
using inverted residuals + ECA attention.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.EfficientAdvancedSynthHead3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#EfficientAdvancedSynthHead3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EfficientAdvancedSynthHead3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (B, C, H, W, D)
returns: (B, 1, H, W, D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.EfficientAdvancedSynthHead3D.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.EfficientAdvancedSynthHead3D.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">EncoderFeatureExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_input_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IActivationFactory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features_per_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_convolutions_per_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizer_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">INormalizerFactory</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/feature_extractor.html#EncoderFeatureExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFeatureExtractor</span></code></p>
<p>Simple convolutional ResNet-style feature extractor with
resolution halved at each stage</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_input_channels</strong> – Number of input channels in the input images</p></li>
<li><p><strong>activation</strong> – Activation to use</p></li>
<li><p><strong>n_features_per_resolution</strong> – Number of features to output for each resolution</p></li>
<li><p><strong>n_convolutions_per_resolution</strong> – Number of convolutions to have for each resolution</p></li>
<li><p><strong>input_shape</strong> – Input volume shape</p></li>
<li><p><strong>normalizer_factory</strong> – Defines the normalizer to use</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/feature_extractor.html#EncoderFeatureExtractor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor.forward" title="Permalink to this definition"></a></dt>
<dd><p>Compute the features</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong> – List of Tensors with shape (batch_size, n_channels, <a href="#id1"><span class="problematic" id="id2">*</span></a>spatial_shape)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor.get_shapes">
<span class="sig-name descname"><span class="pre">get_shapes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/feature_extractor.html#EncoderFeatureExtractor.get_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor.get_shapes" title="Permalink to this definition"></a></dt>
<dd><p>Get shapes at different levels, starting from largest shape</p>
<p>Returns: Sequence of shapes of following form (n_features, dim_1_size, …, dim_n_size)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.EncoderFeatureExtractor.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.EncoderFeatureExtractor.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.GroupNet3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">GroupNet3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[64,</span> <span class="pre">64,</span> <span class="pre">64,</span> <span class="pre">64]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">displacement_field_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mean_conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffeo_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[64,</span> <span class="pre">64,</span> <span class="pre">64]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_instancenorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_half_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_inverse_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#GroupNet3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNet3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.GroupNet3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#GroupNet3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNet3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.GroupNet3D.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.GroupNet3D.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.GroupNormalizerFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">GroupNormalizerFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/normalizer.html#GroupNormalizerFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNormalizerFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">INormalizerFactory</span></code></p>
<p>Factory for generating group normalization layers</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.GroupNormalizerFactory.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/normalizer.html#GroupNormalizerFactory.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.GroupNormalizerFactory.build" title="Permalink to this definition"></a></dt>
<dd><p>Build normalization layer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperTransMorphTVF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composition'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyp_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVF.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVF.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.HyperTransMorphTVF.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVFSPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperTransMorphTVFSPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composition'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVFSPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVFSPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph TVF with Spatially-varying regularization
:param config: Configuration object containing model parameters
:param time_steps: Number of time steps for progressive registration
:param SVF: Boolean indicating whether to use SVF (Time Stationary Velocity Field) integration
:param SVF_steps: Number of steps for SVF integration
:param composition: Type of composition for flow integration (‘composition’ or ‘addition’)
:param swin_type: Type of Swin Transformer to use (‘swin’ or ‘dswin’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVFSPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperTransMorph.html#HyperTransMorphTVFSPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperTransMorphTVFSPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorphTVFSPR model.
:param inputs: Tuple of moving and fixed images (mov, fix).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed flow field for image registration.
x_weight: The spatial weights for regularization.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>flow</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.HyperTransMorphTVFSPR.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.HyperTransMorphTVFSPR.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperVFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperVFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_orginal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA model for image registration
:param configs: VFA configs
:param device: Device to run the model on
:param return_orginal: Whether to return the original deformation field used for original VFA, otherwise return the flow as displacement
:param return_all_flows: Whether to return all flows</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperVFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.HyperVFA.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.HyperVFA.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperVFASPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperVFASPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_orginal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFASPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFASPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA model for image registration with spatially varying regularization (HyperVFA-SPR)
:param configs: VFA configs
:param device: Device to run the model on
:param return_orginal: Whether to return the original deformation field used for original VFA, otherwise return the flow as displacement
:param return_all_flows: Whether to return all flows</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperVFASPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperVFA.html#HyperVFASPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVFASPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.HyperVFASPR.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.HyperVFASPR.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.HyperVxmDense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">HyperVxmDense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperMorph.html#HyperVxmDense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVxmDense" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VoxelMorph network for (unsupervised) nonlinear registration between two images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.HyperVxmDense.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyp_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/HyperMorph.html#HyperVxmDense.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.HyperVxmDense.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – Source image tensor.</p></li>
<li><p><strong>target</strong> – Target image tensor.</p></li>
<li><p><strong>registration</strong> – Return transformed image and flow. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.HyperVxmDense.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.HyperVxmDense.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.ListBatchSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ListBatchSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#ListBatchSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ListBatchSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></p>
<p>Yield precomputed lists of indices as batches.</p>
<p>This allows constructing a DataLoader with arbitrary batch sizes per iteration
while still supporting num_workers and automatic collation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.MappingPair">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">MappingPair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GridComposableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GridComposableMapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/model.html#MappingPair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MappingPair" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Mapping pair containing both forward and inverse deformation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.MappingPair.forward_mapping">
<span class="sig-name descname"><span class="pre">forward_mapping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">GridComposableMapping</span></em><a class="headerlink" href="#MIR.models.MappingPair.forward_mapping" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.MappingPair.inverse_mapping">
<span class="sig-name descname"><span class="pre">inverse_mapping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">GridComposableMapping</span></em><a class="headerlink" href="#MIR.models.MappingPair.inverse_mapping" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.MeanStream">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">MeanStream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(160,</span> <span class="pre">160,</span> <span class="pre">256)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#MeanStream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MeanStream" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Mean stream for the Deformable Template Network
:param cap: Cap for the mean
:param in_shape: Input shape</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.MeanStream.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#MeanStream.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MeanStream.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.MeanStream.mean_update">
<span class="sig-name descname"><span class="pre">mean_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#MeanStream.mean_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.MeanStream.mean_update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.MeanStream.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.MeanStream.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.ReLUFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ReLUFactory</span></span><a class="reference internal" href="_modules/MIR/models/SITReg/activation.html#ReLUFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ReLUFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">IActivationFactory</span></code></p>
<p>Factory for generating relu activations</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.ReLUFactory.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Module</span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/activation.html#ReLUFactory.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ReLUFactory.build" title="Permalink to this definition"></a></dt>
<dd><p>Build activation layer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.RegistrationHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">RegistrationHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#RegistrationHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.RegistrationHead" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequential</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SITReg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SITReg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_extractor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FeatureExtractor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_transformation_features_per_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_transformation_convolutions_per_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_transformation_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AffineTransformationTypeDefinition</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_voxel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation_downsampling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_fixed_point_solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixedPointSolver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_fixed_point_solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FixedPointSolver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_control_point_multiplier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">IActivationFactory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizer_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">INormalizerFactory</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/model.html#SITReg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SITReg" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>SITReg is a deep learning intra-modality image registration arhitecture
fulfilling strict symmetry properties</p>
<p>The implementation is dimensionality agnostic but PyTorch linear interpolation
supports only 2 and 3 dimensional volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_extractor</strong> – Multi-resolution feature extractor</p></li>
<li><p><strong>n_transformation_features_per_resolution</strong> – Defines how many features to
use for extracting transformation in anti-symmetric update for each
resolution. If None is given for some resolution, no deformation is
extracted for that.</p></li>
<li><p><strong>n_transformation_convolutions_per_resolution</strong> – Defines how many convolutions to
use for extracting transformation in anti-symmetric update for each
resolution. If None is given for some resolution, no deformation is
extracted for that.</p></li>
<li><p><strong>affine_transformation_type</strong> – Defines which type of affine transformation
to predict. If None, no affine transformation is predicted.</p></li>
<li><p><strong>input_voxel_size</strong> – Voxel size of the inputs images</p></li>
<li><p><strong>input_shape</strong> – Shape of the input images</p></li>
<li><p><strong>transformation_downsampling_factor</strong> – Downsampling factor for each
dimension for the final deformation, e.g., providing [1.0, 1.0, 1.0] means
no downsampling for three dimensional inputs.</p></li>
<li><p><strong>forward_fixed_point_solver</strong> – Defines fixed point solver for the forward pass
of the deformation inversion layers.</p></li>
<li><p><strong>backward_fixed_point_solver</strong> – Defines fixed point solver for the backward pass
of the deformation inversion layers.</p></li>
<li><p><strong>max_control_point_multiplier</strong> – Optimal maximum control point values are
multiplied with this value to ensure that the individual
deformations are invertible even after numerical errors. This should
be some value just below 1, e.g. 0.99.</p></li>
<li><p><strong>activation_factory</strong> – Activation function to use.</p></li>
<li><p><strong>normalizer_factory</strong> – Normalizer factory to use. If None, no normalization</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SITReg.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings_for_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">((0,</span> <span class="pre">True),)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_when_composing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#MIR.models.MappingPair" title="MIR.models.MappingPair"><span class="pre">MappingPair</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/MIR/models/SITReg/sitreg/model.html#SITReg.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SITReg.forward" title="Permalink to this definition"></a></dt>
<dd><p>Generate deformations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_1</strong> – Image registered to image_2, Tensor with shape
(batch_size, n_channels, dim_1, …, dim_{n_dims})</p></li>
<li><p><strong>image_2</strong> – Image registered to image_1, Tensor with shape
(batch_size, n_channels, dim_1, …, dim_{n_dims})</p></li>
<li><p><strong>deformations_for_levels</strong> – Defines for which resolution levels the
deformations are returned. The first element of each tuple is
the index of the level and the second element indicates whether
to include affine transformation in the deformation. Indexing
starts from the highest resolution. Default value is [(0, True)]
which corresponds to returning the full deformation at the
highest resolution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of MappingPairs in the order given by the input argument
“mappings_for_levels”</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MIR.models.SITReg.image_coordinate_system">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_coordinate_system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CoordinateSystem</span></em><a class="headerlink" href="#MIR.models.SITReg.image_coordinate_system" title="Permalink to this definition"></a></dt>
<dd><p>Coordinate system used by the network for the inputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SITReg.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SITReg.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MIR.models.SITReg.transformation_coordinate_system">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformation_coordinate_system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">CoordinateSystem</span></em><a class="headerlink" href="#MIR.models.SITReg.transformation_coordinate_system" title="Permalink to this definition"></a></dt>
<dd><p>Coordinate system used by the predicted transformations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SSLHead1Lvl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SSLHead1Lvl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_lvls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(384,</span> <span class="pre">192,</span> <span class="pre">96)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_upsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_encoder_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHead1Lvl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHead1Lvl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Self-supervised learning head with one level
:param encoder: Encoder model
:param img_size: Image size
:param num_lvls: Number of levels
:param channels: Number of channels
:param if_upsamp: Whether to upsample
:param encoder_output_type: Type of encoder output (‘single’ or ‘multi’)
:param encoder_input_type: Type of encoder input (‘single’, ‘multi’, or ‘separate’)
:param swap_encoder_order: Whether to swap encoder’s output order
:param gen_output: Whether to generate deformed output</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SSLHead1Lvl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHead1Lvl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHead1Lvl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SSLHead1Lvl.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SSLHead1Lvl.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SSLHeadNLvl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SSLHeadNLvl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_lvls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(384,</span> <span class="pre">192,</span> <span class="pre">96)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_upsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_input_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_encoder_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHeadNLvl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHeadNLvl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Self-supervised learning head with multiple levels
:param encoder: Encoder model
:param img_size: Image size
:param num_lvls: Number of levels
:param channels: Number of channels
:param if_upsamp: Whether to upsample
:param encoder_output_type: Type of encoder output (‘single’ or ‘multi’)
:param encoder_input_type: Type of encoder input (‘single’, ‘multi’, or ‘separate’)
:param swap_encoder_order: Whether to swap encoder’s output order
:param gen_output: Whether to generate deformed output</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SSLHeadNLvl.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Selfsupervised_Learning_Heads.html#SSLHeadNLvl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SSLHeadNLvl.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SSLHeadNLvl.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SSLHeadNLvl.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SpatialTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SpatialTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#SpatialTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SpatialTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>N-D Spatial Transformer
Obtained from <a class="reference external" href="https://github.com/voxelmorph/voxelmorph">https://github.com/voxelmorph/voxelmorph</a>
:param size: spatial size of the input tensor
:param mode: interpolation mode, ‘bilinear’ or ‘nearest’</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SpatialTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#SpatialTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SpatialTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SpatialTransformer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SpatialTransformer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SwinTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pretrain_img_size=224,</span> <span class="pre">patch_size=4,</span> <span class="pre">in_chans=3,</span> <span class="pre">embed_dim=96,</span> <span class="pre">depths=[2,</span> <span class="pre">2,</span> <span class="pre">6,</span> <span class="pre">2],</span> <span class="pre">num_heads=[3,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">24],</span> <span class="pre">window_size=(7,</span> <span class="pre">7,</span> <span class="pre">7),</span> <span class="pre">mlp_ratio=4.0,</span> <span class="pre">qkv_bias=True,</span> <span class="pre">qk_scale=None,</span> <span class="pre">drop_rate=0.0,</span> <span class="pre">attn_drop_rate=0.0,</span> <span class="pre">drop_path_rate=0.2,</span> <span class="pre">norm_layer=&lt;class</span> <span class="pre">'torch.nn.modules.normalization.LayerNorm'&gt;,</span> <span class="pre">ape=False,</span> <span class="pre">spe=False,</span> <span class="pre">rpe=True,</span> <span class="pre">patch_norm=True,</span> <span class="pre">out_indices=(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">frozen_stages=-1,</span> <span class="pre">use_checkpoint=False,</span> <span class="pre">pat_merg_rf=2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl>
<dt>Swin Transformer</dt><dd><dl>
<dt>A PyTorch impl of<span class="classifier"><cite>Swin Transformer: Hierarchical Vision Transformer using Shifted Windows</cite>  -</span></dt><dd><p><a class="reference external" href="https://arxiv.org/pdf/2103.14030">https://arxiv.org/pdf/2103.14030</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Input image size. Default 224</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em> | </em><em>tuple</em><em>(</em><em>int</em><em>)</em>) – Patch size. Default: 4</p></li>
<li><p><strong>in_chans</strong> (<em>int</em>) – Number of input image channels. Default: 3</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of classes for classification head. Default: 1000</p></li>
<li><p><strong>embed_dim</strong> (<em>int</em>) – Patch embedding dimension. Default: 96</p></li>
<li><p><strong>depths</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Depth of each Swin Transformer layer.</p></li>
<li><p><strong>num_heads</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – Number of attention heads in different layers.</p></li>
<li><p><strong>window_size</strong> (<em>tuple</em>) – Window size. Default: 7</p></li>
<li><p><strong>mlp_ratio</strong> (<em>float</em>) – Ratio of mlp hidden dim to embedding dim. Default: 4</p></li>
<li><p><strong>qkv_bias</strong> (<em>bool</em>) – If True, add a learnable bias to query, key, value. Default: True</p></li>
<li><p><strong>qk_scale</strong> (<em>float</em>) – Override default qk scale of head_dim ** -0.5 if set. Default: None</p></li>
<li><p><strong>drop_rate</strong> (<em>float</em>) – Dropout rate. Default: 0</p></li>
<li><p><strong>attn_drop_rate</strong> (<em>float</em>) – Attention dropout rate. Default: 0</p></li>
<li><p><strong>drop_path_rate</strong> (<em>float</em>) – Stochastic depth rate. Default: 0.1</p></li>
<li><p><strong>norm_layer</strong> (<em>nn.Module</em>) – Normalization layer. Default: nn.LayerNorm.</p></li>
<li><p><strong>ape</strong> (<em>bool</em>) – If True, add absolute position embedding to the patch embedding. Default: False</p></li>
<li><p><strong>patch_norm</strong> (<em>bool</em>) – If True, add normalization after patch embedding. Default: True</p></li>
<li><p><strong>use_checkpoint</strong> (<em>bool</em>) – Whether to use checkpointing to save memory. Default: False</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer.init_weights" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the weights in backbone.
:param pretrained: Path to pre-trained weights.</p>
<blockquote>
<div><p>Defaults to None.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Swin_Transformer.html#SwinTransformer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SwinTransformer.train" title="Permalink to this definition"></a></dt>
<dd><p>Convert the model into training mode while keep layers freezed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SwinTransformer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SwinTransformer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SynthesisHead3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'instance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'leaky_relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Simple Synthesis head for 3D features (specifically for VFA encoders)
:param in_channels: Number of input channels
:param mid_channels: Number of intermediate channels
:param out_channels: Number of output channels
:param norm: Normalization type (‘instance’ or ‘batch’)
:param activation: Activation function (‘leaky_relu’ or ‘relu’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3D.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (B, C, H, W, D)
returns: (B, 1, H, W, D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3D.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SynthesisHead3D.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3DAdvanced">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">SynthesisHead3DAdvanced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_res_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'instance'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3DAdvanced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3DAdvanced" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Synthesis head with Residual and SE blocks for 3D features (specifically for VFA encoders)
:param in_channels: Number of input channels
:param mid_channels: Number of intermediate channels
:param num_res_blocks: Number of residual blocks
:param norm: Normalization type (‘instance’ or ‘group’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3DAdvanced.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/MIR/models/Synthesis_Heads.html#SynthesisHead3DAdvanced.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.SynthesisHead3DAdvanced.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (B, C, H, W, D)
returns: (B, 1, H, W, D)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.SynthesisHead3DAdvanced.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.SynthesisHead3DAdvanced.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TemplateCreation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TemplateCreation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reg_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_cap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sitreg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#TemplateCreation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TemplateCreation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Deformable Template Network
:param reg_model: Registration model
:param img_size: Image size
:param mean_cap: Mean cap for the MeanStream
:param use_sitreg: Use SITReg-style mapping outputs when True; VFA, TransMorph, VoxelMorph-style otherwise
:param mode: SpatialTransformer interpolation mode (SITReg path)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TemplateCreation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/atlas_builder.html#TemplateCreation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TemplateCreation.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.TemplateCreation.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.TemplateCreation.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swin_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'swin'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorph" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph model
:param config: Configuration object containing model parameters
:param SVF: Boolean indicating whether to use SVF (Time Stationary Velocity Field) integration
:param SVF_steps: Number of steps for SVF integration
:param swin_type: Type of Swin Transformer to use (‘swin’ or ‘dswin’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorph.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorph.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorph.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorph model.
:param inputs: Tuple of moving and fixed images (mov, fix).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed flow field for image registration.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>flow</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.TransMorph.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.TransMorph.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorphAffine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swin_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphAffine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphAffine" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph Affine
:param config: Configuration object containing model parameters
:param swin_type: Type of Swin Transformer to use (‘swin’ or ‘dswin’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphAffine.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphAffine.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine.softplus">
<span class="sig-name descname"><span class="pre">softplus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphAffine.softplus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphAffine.softplus" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.TransMorphAffine.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.TransMorphAffine.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorphTVF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composition'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swin_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'swin'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph TVF
:param config: Configuration object containing model parameters
:param time_steps: Number of time steps for progressive registration
:param SVF: Boolean indicating whether to use SVF (Time Stationary Velocity Field) integration
:param SVF_steps: Number of steps for SVF integration
:param composition: Type of composition for flow integration (‘composition’ or ‘addition’)
:param swin_type: Type of Swin Transformer to use (‘swin’ or ‘dswin’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVF.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorphTVF model.
:param inputs: Tuple of moving and fixed images (mov, fix).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed flow field for image registration.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>flow</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVF.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.TransMorphTVF.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVFSPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransMorphTVFSPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'composition'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swin_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'swin'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVFSPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVFSPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransMorph TVF with Spatially-varying regularization
:param config: Configuration object containing model parameters
:param time_steps: Number of time steps for progressive registration
:param SVF: Boolean indicating whether to use SVF (Time Stationary Velocity Field) integration
:param SVF_steps: Number of steps for SVF integration
:param composition: Type of composition for flow integration (‘composition’ or ‘addition’)
:param swin_type: Type of Swin Transformer to use (‘swin’ or ‘dswin’)</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVFSPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransMorph.html#TransMorphTVFSPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransMorphTVFSPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass for the TransMorphTVFSPR model.
:param inputs: Tuple of moving and fixed images (mov, fix).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed flow field for image registration.
x_weight: The spatial weights for regularization.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>flow</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.TransMorphTVFSPR.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.TransMorphTVFSPR.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.TransVFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">TransVFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs_sw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swin_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'swin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_orginal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransVFA.html#TransVFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransVFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>TransVFA model for image registration
:param configs_sw: Swin Transformer configs
:param configs: VFA configs
:param device: Device to run the model on
:param swin_type: Type of Swin Transformer (‘swin’ or ‘dswin’)
:param return_orginal: Whether to return the original deformation field used for original VFA, otherwise return the flow as displacement
:param return_all_flows: Whether to return all flows</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.TransVFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/TransVFA.html#TransVFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.TransVFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.TransVFA.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.TransVFA.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_orginal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA model for image registration
:param configs: VFA configs
:param device: Device to run the model on
:param return_orginal: Whether to return the original deformation field used for original VFA, otherwise return the flow as displacement
:param return_all_flows: Whether to return all flows</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.VFA.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.VFA.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VFASPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VFASPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_orginal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_flows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SVF_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFASPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFASPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VFA model for image registration with spatially varying regularization (VFA-SPR)
:param configs: VFA configs
:param device: Device to run the model on
:param return_orginal: Whether to return the original deformation field used for original VFA, otherwise return the flow as displacement
:param return_all_flows: Whether to return all flows</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VFASPR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#VFASPR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VFASPR.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.VFASPR.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.VFASPR.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VecInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VecInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inshape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#VecInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VecInt" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Integrates a vector field via scaling and squaring.
:param inshape: shape of the input tensor
:param nsteps: number of integration steps</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VecInt.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#VecInt.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VecInt.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.VecInt.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.VecInt.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.VxmDense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">VxmDense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VoxelMorph.html#VxmDense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VxmDense" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VoxelMorph network for (unsupervised) nonlinear registration between two images.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.VxmDense.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_imgs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VoxelMorph.html#VxmDense.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.VxmDense.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – Source image tensor.</p></li>
<li><p><strong>target</strong> – Target image tensor.</p></li>
<li><p><strong>registration</strong> – Return transformed image and flow. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.VxmDense.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.VxmDense.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MIR.models.Warp3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">Warp3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vol_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bilinear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#Warp3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Warp3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MIR.models.Warp3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#Warp3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.Warp3d.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MIR.models.Warp3d.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#MIR.models.Warp3d.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_MIND">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_MIND</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_MIND.html#convex_adam_MIND"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_MIND" title="Permalink to this definition"></a></dt>
<dd><p>Coupled convex optimisation with adam instance optimisation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_MIND_SPR">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_MIND_SPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_MIND_SPR.html#convex_adam_MIND_SPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_MIND_SPR" title="Permalink to this definition"></a></dt>
<dd><p>Coupled convex optimisation with adam instance optimisation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_features">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_features.html#convex_adam_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_features" title="Permalink to this definition"></a></dt>
<dd><p>Coupled convex optimisation with adam instance optimisation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.convex_adam_seg_features">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">convex_adam_seg_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_moving</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/convexAdam/convex_adam_nnUNet.html#convex_adam_seg_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.convex_adam_seg_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.ensemble_average">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">ensemble_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#ensemble_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.ensemble_average" title="Permalink to this definition"></a></dt>
<dd><p>Ensemble average of displacement fields or SVFs.
:param fields: list of displacement fields, each (<a href="#id3"><span class="problematic" id="id4">*</span></a>vol, ndims)
:param field_types: parallel list, ‘svf’ or ‘disp’
:param weights: list of floats or None (defaults to equal)
:param nb_steps: number of integration steps for VecInt
:param iters: number of iterations for fit_warp_to_svf</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy displacement field (<a href="#id5"><span class="problematic" id="id6">*</span></a>vol, ndims) = exp(Σ w_i v_i)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>disp_bar</p>
</dd>
</dl>
<p># assume you already have three predictions:
svf_A   = np.load(“model_A_velocity.npy”)    # (<a href="#id7"><span class="problematic" id="id8">*</span></a>vol, 3)
disp_B  = np.load(“model_B_disp.npy”)        # (<a href="#id9"><span class="problematic" id="id10">*</span></a>vol, 3)
disp_C  = np.load(“model_C_disp.npy”)</p>
<p>fields      = [svf_A, disp_B, disp_C]
field_types = [‘svf’, ‘disp’, ‘disp’]
# e.g. let Dice on a small val‑set decide the weights
weights     = [0.45, 0.35, 0.20]</p>
<dl class="simple">
<dt>disp_mean = ensemble_average(</dt><dd><p>fields,
field_types,
weights,
nb_steps=7,          # same nsteps you used during training/inference
iters=150,           # iterations for fit_warp_to_svf on the disp fields</p>
</dd>
</dl>
<p>)</p>
<p># now warp any tensor (image, mask, logits) with the consensus deformation
vol_shape = disp_mean.shape[:-1]
transform = SpatialTransformer(vol_shape).cuda()         # if GPU used above
moving_img_t = torch.from_numpy(moving_img)[None, None].float().cuda()
disp_t = torch.from_numpy(disp_mean).permute(3,0,1,2)[None].float().cuda()
warped = transform(moving_img_t, disp_t)                 # (1,1,*vol)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.fit_warp_to_svf">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">fit_warp_to_svf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warp_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'warp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'disp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#fit_warp_to_svf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.fit_warp_to_svf" title="Permalink to this definition"></a></dt>
<dd><p>Fit a stationary‑velocity field v so that exp(v) ≈ given displacement field.
Parameters mirror the original TF implementation.
<cite>warp</cite> shape: (<a href="#id11"><span class="problematic" id="id12">*</span></a>vol_shape, ndims)  (numpy array or torch tensor)
Returns: v as a numpy array of same shape.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorph3Lvl_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorph3Lvl_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorph3Lvl_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorph3Lvl_config" title="Permalink to this definition"></a></dt>
<dd><p>Trainable params: 15,201,579</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphDWin3Lvl_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphDWin3Lvl_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphDWin3Lvl_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphDWin3Lvl_config" title="Permalink to this definition"></a></dt>
<dd><p>Trainable params: 15,201,579</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphLarge_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphLarge_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphLarge_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphLarge_config" title="Permalink to this definition"></a></dt>
<dd><p>A Large TransMorph Network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphLrn_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphLrn_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphLrn_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphLrn_config" title="Permalink to this definition"></a></dt>
<dd><p>TransMorph with Learnable Positional Embedding</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoConvSkip_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoConvSkip_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoConvSkip_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoConvSkip_config" title="Permalink to this definition"></a></dt>
<dd><p>No skip connections from convolution layers</p>
<p>Computational complexity:       577.34 GMac
Number of parameters:           63.56 M</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoRelativePosEmbd_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoRelativePosEmbd_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoRelativePosEmbd_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoRelativePosEmbd_config" title="Permalink to this definition"></a></dt>
<dd><p>Trainable params: 15,201,579</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoSkip_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoSkip_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoSkip_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoSkip_config" title="Permalink to this definition"></a></dt>
<dd><p>No skip connections</p>
<p>Computational complexity:       639.93 GMac
Number of parameters:           58.4 M</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphNoTransSkip_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphNoTransSkip_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphNoTransSkip_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphNoTransSkip_config" title="Permalink to this definition"></a></dt>
<dd><p>No skip connections from Transformer blocks</p>
<p>Computational complexity:       639.93 GMac
Number of parameters:           58.4 M</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphRelativePosEmbdSimple_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphRelativePosEmbdSimple_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphRelativePosEmbdSimple_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphRelativePosEmbdSimple_config" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphSin_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphSin_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphSin_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphSin_config" title="Permalink to this definition"></a></dt>
<dd><p>TransMorph with Sinusoidal Positional Embedding</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphSmall_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphSmall_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphSmall_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphSmall_config" title="Permalink to this definition"></a></dt>
<dd><p>A Small TransMorph Network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorphTiny_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorphTiny_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorphTiny_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorphTiny_config" title="Permalink to this definition"></a></dt>
<dd><p>A Tiny TransMorph Network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_3DTransMorph_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_3DTransMorph_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_TransMorph.html#get_3DTransMorph_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_3DTransMorph_config" title="Permalink to this definition"></a></dt>
<dd><p>Trainable params: 15,201,579</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_ConvexAdam_MIND_brain_default_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_ConvexAdam_MIND_brain_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/convexAdam/configs_ConvexAdam_MIND.html#get_ConvexAdam_MIND_brain_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_ConvexAdam_MIND_brain_default_config" title="Permalink to this definition"></a></dt>
<dd><p>ConvexAdam MIND default config.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VFA_default_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VFA_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VFA.html#get_VFA_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VFA_default_config" title="Permalink to this definition"></a></dt>
<dd><p>VFA default config.
config.name: str, name of the model.
config.skip: int, skip certain displacement fields in the decoder.
config.initialize: float, initialize beta in the decoder.
config.downsamples: int, number of downsampling layers in the encoder.
config.start_channels: int, number of channels in the first layer of the encoder.
config.matching_channels: int, number of channels in the matching layer of the encoder.
config.int_steps: int, number of integration steps in the decoder.
config.affine: int, whether to use affine transformation in the decoder.
config.img_size: tuple, size of the input image.
config.in_channels: int, number of input channels.
config.max_channels: int, maximum number of channels in the encoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VXM_1_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VXM_1_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VoxelMorph.html#get_VXM_1_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VXM_1_config" title="Permalink to this definition"></a></dt>
<dd><p>VoxelMorph-1 config.
config.img_size: tuple, size of the input image.
config.nb_unet_features: tuple, number of features in the encoder and decoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VXM_BJ_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VXM_BJ_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VoxelMorph.html#get_VXM_BJ_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VXM_BJ_config" title="Permalink to this definition"></a></dt>
<dd><p>VoxelMorph_BJ config.
config.img_size: tuple, size of the input image.
config.nb_unet_features: tuple, number of features in the encoder and decoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.get_VXM_default_config">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">get_VXM_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/configs_VoxelMorph.html#get_VXM_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.get_VXM_default_config" title="Permalink to this definition"></a></dt>
<dd><p>VoxelMorph-2 config.
config.img_size: tuple, size of the input image.
config.nb_unet_features: tuple, number of features in the encoder and decoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.grid_to_flow">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">grid_to_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/VFA.html#grid_to_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.grid_to_flow" title="Permalink to this definition"></a></dt>
<dd><p>Convert an absolute sampling grid (as produced by VFA) to a
voxel‑displacement field that VoxelMorph’s SpatialTransformer expects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grid</strong> (Tensor, shape [B, ndim, <a href="#id13"><span class="problematic" id="id14">*</span></a>spatial_dims]) – Absolute coordinates in pixel units (0 … size‑1).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>flow</strong> – Displacements relative to the identity grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor, same shape as <cite>grid</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.invert_warp_via_velocity">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">invert_warp_via_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/registration_utils.html#invert_warp_via_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.invert_warp_via_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Approximate inverse by: fit v, then integrate ‑v.
Returns a displacement field (numpy) of same shape.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MIR.models.make_epoch_batches">
<span class="sig-prename descclassname"><span class="pre">MIR.models.</span></span><span class="sig-name descname"><span class="pre">make_epoch_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MIR/models/MultiMorph.html#make_epoch_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MIR.models.make_epoch_batches" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="MIR Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>